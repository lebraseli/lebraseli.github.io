<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>The Archive</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>

  <body>
    <header class="topbar">
      <div class="brand">
        <div class="brand__icon" aria-hidden="true">üß≠</div>
        <div class="brand__text">
          <div class="brand__title">The Archive</div>
          <div class="brand__subtitle">One artifact. One sequence. One way through.</div>
        </div>
      </div>

      <div class="topbar__actions">
        <button id="btnHints" class="btn btn--ghost" type="button">Hints</button>
        <button id="btnContrast" class="btn btn--ghost" type="button" aria-pressed="false">High Contrast</button>
      </div>
    </header>

    <main class="shell">
      <!-- STAGE 1: "AI CHECK" DESCRIPTION GATE -->
      <section id="stage-ai" class="card card--hero" aria-labelledby="aiTitle">
        <div class="card__head">
          <h1 id="aiTitle">Mission Brief</h1>
          <p class="muted">
            You do not have the physical copy. Your first task is to <strong>describe what you see</strong>.
            If your description is plausible, the archive will unlock the next prompt.
          </p>
        </div>

        <div class="split">
          <div class="pane">
            <div class="pane__title">
              Evidence
              <span class="pill">E-001</span>
            </div>

            <figure class="evidence">
              <img
                src="./assets/island-water.png"
                alt="Evidence image"
                loading="eager"
                decoding="async"
              />
              <figcaption class="muted">
                Open and zoom. A hidden sequence is present, but it‚Äôs not announced.
              </figcaption>
            </figure>
          </div>

          <div class="pane">
            <div class="pane__title">
              Verification
              <span class="pill pill--soft">Local</span>
            </div>

            <label class="field">
              <span class="field__label">Describe the evidence</span>
              <textarea
                id="aiInput"
                class="input textarea"
                rows="7"
                placeholder="Write what you think the image shows. Be specific."
                autocomplete="off"
                spellcheck="false"
              ></textarea>
              <span class="field__hint">This is a UX gate. No external calls.</span>
            </label>

            <div class="row">
              <button id="aiValidate" class="btn btn--primary" type="button">Run AI check</button>
              <button id="aiClear" class="btn btn--ghost" type="button">Clear</button>
            </div>

            <div id="aiResult" class="result" aria-live="polite"></div>

            <div class="divider"></div>

            <details class="details">
              <summary>How the ‚ÄúAI check‚Äù works</summary>
              <p class="muted">
                It‚Äôs a deterministic semantic scorer: it requires multiple independent concepts
                (water + islands + hidden sequence cues) and rejects repetitive / low-effort strings.
              </p>
            </details>
          </div>
        </div>
      </section>

      <!-- STAGE 2: ENTER THE ISLAND/WATER CODE -->
      <section id="stage-code1" class="card hidden" aria-labelledby="code1Title">
        <div class="card__head">
          <h2 id="code1Title">Submit the sequence</h2>
          <p class="muted">
            Enter what you believe the sequence is. Capitalization doesn‚Äôt matter. Spaces/punctuation are ignored.
          </p>
        </div>

        <div class="entry">
          <input
            id="code1Input"
            class="input"
            type="text"
            inputmode="text"
            autocomplete="off"
            placeholder="Enter sequence"
          />
          <button id="code1Btn" class="btn btn--primary" type="button">Validate</button>
        </div>

        <div id="code1Feedback" class="feedback" aria-live="polite"></div>
      </section>

      <!-- STAGE 3: BLINKING SCREEN + INVISIBLE PASSWORD CAPTURE -->
      <section id="stage-blink" class="blink hidden" aria-hidden="true">
        <div class="blink__overlay">
          <!-- invisible full-screen input that captures keyboard -->
          <input
            id="blinkInput"
            class="blink__input"
            type="password"
            inputmode="numeric"
            autocomplete="one-time-code"
            aria-label="Hidden input"
          />
          <div class="blink__hint" aria-hidden="true"></div>
        </div>
      </section>

      <!-- STAGE 4: ORIGAMI WORD (AUTO IN/OUT), THEN WAIT FOR 1324 AGAIN -->
      <section id="stage-origami" class="origami hidden" aria-hidden="true">
        <div class="origami__canvas">
          <div id="origamiWord" class="origami__word">Origami</div>
          <input
            id="origamiInput"
            class="origami__input"
            type="password"
            inputmode="numeric"
            autocomplete="one-time-code"
            aria-label="Hidden input"
          />
        </div>
      </section>

      <!-- STAGE 5: FINAL ENTRY (BURNT MARKS) -->
      <section id="stage-code2" class="card hidden" aria-labelledby="code2Title">
        <div class="card__head">
          <h2 id="code2Title">Final Entry</h2>
          <p class="muted">
            Enter the next sequence.
          </p>
        </div>

        <div class="entry">
          <input
            id="code2Input"
            class="input"
            type="text"
            inputmode="numeric"
            autocomplete="off"
            placeholder="Enter sequence"
          />
          <button id="code2Btn" class="btn btn--primary" type="button">Validate</button>
        </div>

        <div id="code2Feedback" class="feedback" aria-live="polite"></div>
      </section>

      <!-- STAGE 6: COMPLETE -->
      <section id="stage-done" class="card hidden" aria-labelledby="doneTitle">
        <div class="card__head">
          <h2 id="doneTitle">Access Granted</h2>
          <p class="muted">Proceed.</p>
        </div>
      </section>

      <footer class="footer muted">
        Static site. No tracking. No external calls.
      </footer>
    </main>

    <div id="toast" class="toast" aria-live="polite" aria-atomic="true"></div>

    <script src="./app.js"></script>
  </body>
</html>
