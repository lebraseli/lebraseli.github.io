<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Between The Colors</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- not everything is meant to be seen -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
:root{
  /* Pastel controls */
  --pastel-opacity: 1;
  --pastel-brightness: 110%;
  --pastel-saturate: 110%;
  --pastel-huerotate: 0deg;
  --pastel-blur: 0px;
  --pastel-contrast: 100%;
  --pastel-rotate: 0deg;
  --pastel-scale: 1;
  --pastel-x: 0px;
  --pastel-y: 0px;

  /* Inspect controls */
  --inspect-opacity: 0.012;
  --inspect-brightness: 99%;
  --inspect-contrast: 101%;
  --inspect-blur: .45px;
  --inspect-letterspacing: .34em;

  /* Buttons controls */
  --buttons-blur: 0px;
  --buttons-glow: 0px;
  --buttons-outline: 0px;

  /* Mask overlay */
  --vignette-opacity: 0;
}

html, body {
  margin: 0;
  height: 100%;
  overflow: hidden;
  background: #fdfdfd;
  font-family: system-ui, sans-serif;
}

/* ===== FINAL URL ===== */
#final {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  font-size: 2.8rem;
  font-weight: 600;
  opacity: 0;
  z-index: 1;
  transition: opacity 1.2s ease;
}
#final span { color: #111; }

/* ===== HIDDEN WORD ===== */
#inspect {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;

  font-size: 16vw;
  font-weight: 900;
  letter-spacing: var(--inspect-letterspacing);

  /* tuned to survive quantization while staying near-invisible */
  color: rgb(246,246,246);
  opacity: var(--inspect-opacity);

  mix-blend-mode: difference;

  text-shadow:
    0 0 .6px rgba(0,0,0,.025),
    0 0 1.2px rgba(0,0,0,.015);

  filter:
    blur(var(--inspect-blur))
    contrast(var(--inspect-contrast))
    brightness(var(--inspect-brightness));

  pointer-events: none;
  user-select: none;
  z-index: 2;
}

/* ===== PASTEL WASH ===== */
#pastel {
  position: fixed;
  inset: 0;
  background:
    radial-gradient(circle at 20% 30%, #f7b7d2 0%, transparent 60%),
    radial-gradient(circle at 80% 20%, #b7ccff 0%, transparent 60%),
    radial-gradient(circle at 50% 80%, #fff0b3 0%, transparent 60%),
    linear-gradient(120deg, rgba(255,200,210,.5), rgba(200,210,255,.5));
  opacity: var(--pastel-opacity);
  filter:
    brightness(var(--pastel-brightness))
    saturate(var(--pastel-saturate))
    hue-rotate(var(--pastel-huerotate))
    blur(var(--pastel-blur))
    contrast(var(--pastel-contrast));
  mix-blend-mode: multiply;
  z-index: 5;
  transition: opacity 1.2s ease, filter .6s ease;
  transform:
    translate(var(--pastel-x), var(--pastel-y))
    rotate(var(--pastel-rotate))
    scale(var(--pastel-scale));
  transform-origin: 20% 20%;
  will-change: transform, clip-path, opacity, filter;
}

/* Peel edge illusion */
#pastel::after{
  content:"";
  position:absolute;
  inset:-10%;
  pointer-events:none;
  opacity:0;
  background: radial-gradient(closest-side, rgba(0,0,0,.12), transparent 65%);
  mix-blend-mode:multiply;
  filter: blur(12px);
  transition: opacity .4s ease;
}

/* Peeling animation */
#pastel.peeling {
  animation: peelOff 1.25s cubic-bezier(.2,.9,.2,1) forwards;
}
#pastel.peeling::after{
  opacity: .75;
}

@keyframes peelOff {
  0% {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
    transform: translate(0px,0px) rotate(0deg) scale(1);
    opacity: 1;
  }
  35% {
    clip-path: polygon(0 0, 100% 0, 94% 72%, 62% 92%, 25% 88%, 0 74%);
    transform: translate(-8px, -6px) rotate(-3deg) scale(1.02);
    opacity: 1;
  }
  70% {
    clip-path: polygon(0 0, 78% 0, 62% 40%, 48% 55%, 20% 62%, 0 48%);
    transform: translate(-28px, -22px) rotate(-9deg) scale(1.04);
    opacity: .55;
  }
  100% {
    clip-path: polygon(0 0, 30% 0, 18% 18%, 10% 25%, 0 22%);
    transform: translate(-80px, -70px) rotate(-18deg) scale(1.06);
    opacity: 0;
  }
}

/* ===== VIGNETTE / MASK OVERLAY (for “Mask”) ===== */
#vignette {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 7;
  opacity: var(--vignette-opacity);
  transition: opacity .4s ease;
  background:
    radial-gradient(circle at 50% 50%, rgba(255,255,255,0) 45%, rgba(0,0,0,.18) 85%, rgba(0,0,0,.30) 100%);
  mix-blend-mode: multiply;
}

/* ===== BUTTON GRID ===== */
#buttons {
  position: fixed;
  inset: 0;
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  grid-template-rows: repeat(5, 1fr);
  gap: 12px;
  padding: 32px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s ease;
  z-index: 10;
  filter: blur(var(--buttons-blur));
}

.button {
  background: rgba(255,255,255,.75);
  border-radius: 18px;
  backdrop-filter: blur(12px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: .7rem;
  cursor: pointer;
  box-shadow:
    0 12px 30px rgba(0,0,0,.15),
    0 0 var(--buttons-glow) rgba(120,120,120,.30);
  transition: transform .25s ease, box-shadow .25s ease, filter .25s ease;
  outline: var(--buttons-outline) solid rgba(0,0,0,.12);
  outline-offset: -2px;
}
.button:hover { transform: scale(1.10); }
.button i { font-size: 1.4rem; margin-bottom: 6px; }
.button.ping { animation: ping .45s ease; }
@keyframes ping { 0%{transform:scale(1)} 50%{transform:scale(1.08)} 100%{transform:scale(1)} }

/* ===== FX OVERLAY (BIG NOTICEABLE EFFECTS) ===== */
#fx {
  position: fixed;
  inset: 0;
  z-index: 25;
  pointer-events: none;
  opacity: 0;
  transition: opacity .25s ease;
}
#fx.active { opacity: 1; }

.fx-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(255,255,255,.0);
  backdrop-filter: blur(0px);
}

.fx-title {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  font-weight: 900;
  letter-spacing: .08em;
  text-transform: uppercase;
  opacity: .9;
}

.fx-title .word {
  font-size: clamp(42px, 10vw, 120px);
  padding: 20px 28px;
  border-radius: 28px;
  background: rgba(255,255,255,.55);
  backdrop-filter: blur(18px);
  box-shadow: 0 24px 80px rgba(0,0,0,.18);
}

.fx-icon {
  font-size: clamp(38px, 8vw, 110px);
  margin-bottom: 18px;
}

.fx-particles {
  position: absolute;
  inset: -20%;
  overflow: hidden;
}

.fx-ring {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 20px;
  height: 20px;
  border-radius: 999px;
  transform: translate(-50%, -50%);
  box-shadow: 0 0 0 0 rgba(0,0,0,.12);
}

/* Generic BIG “ripple + drift” */
@keyframes fxRipple {
  0%   { box-shadow: 0 0 0 0 rgba(0,0,0,.10), 0 0 0 0 rgba(0,0,0,.06); opacity: .95; }
  70%  { box-shadow: 0 0 0 60vmax rgba(0,0,0,.08), 0 0 0 25vmax rgba(0,0,0,.04); opacity: .85; }
  100% { box-shadow: 0 0 0 80vmax rgba(0,0,0,0), 0 0 0 40vmax rgba(0,0,0,0); opacity: 0; }
}
@keyframes fxFloat {
  0% { transform: translate(-50%, -50%) translateY(0px) scale(1); }
  50% { transform: translate(-50%, -50%) translateY(-14px) scale(1.02); }
  100% { transform: translate(-50%, -50%) translateY(0px) scale(1); }
}

/* Screen shake */
@keyframes fxShake {
  0%{ transform: translate(0,0) } 10%{ transform: translate(-6px,4px) }
  20%{ transform: translate(5px,-3px) } 30%{ transform: translate(-8px,-2px) }
  40%{ transform: translate(7px,5px) } 50%{ transform: translate(-4px,-6px) }
  60%{ transform: translate(6px,2px) } 70%{ transform: translate(-3px,4px) }
  80%{ transform: translate(4px,-4px) } 90%{ transform: translate(-2px,2px) }
  100%{ transform: translate(0,0) }
}

/* Fog */
@keyframes fxFog {
  0% { transform: translateX(-20%) scale(1.1); opacity: .0; }
  10% { opacity: .7; }
  60% { opacity: .65; }
  100% { transform: translateX(20%) scale(1.1); opacity: 0; }
}
.fx-fog {
  position: absolute;
  inset: -20%;
  background: radial-gradient(circle at 20% 30%, rgba(255,255,255,.85), transparent 60%),
              radial-gradient(circle at 70% 70%, rgba(255,255,255,.65), transparent 60%),
              radial-gradient(circle at 50% 50%, rgba(255,255,255,.5), transparent 70%);
  mix-blend-mode: screen;
  filter: blur(26px);
  animation: fxFog 10s ease forwards;
}

/* Ladybug crawl (SVG container) */
@keyframes bugCrawl {
  0% { transform: translate(-20vw, 80vh) rotate(-6deg) scale(1); }
  15% { transform: translate(10vw, 70vh) rotate(4deg) scale(1.05); }
  35% { transform: translate(40vw, 62vh) rotate(-3deg) scale(1.02); }
  55% { transform: translate(65vw, 54vh) rotate(6deg) scale(1.08); }
  75% { transform: translate(88vw, 44vh) rotate(-4deg) scale(1.04); }
  100% { transform: translate(120vw, 35vh) rotate(3deg) scale(1.05); }
}
@keyframes bugWiggle {
  0%,100%{ transform: rotate(0deg) }
  25%{ transform: rotate(4deg) }
  50%{ transform: rotate(-5deg) }
  75%{ transform: rotate(3deg) }
}
.fx-bug {
  position: absolute;
  left: 0;
  top: 0;
  width: clamp(120px, 14vw, 220px);
  height: auto;
  filter: drop-shadow(0 18px 22px rgba(0,0,0,.25));
  animation: bugCrawl 10.5s cubic-bezier(.2,.8,.2,1) forwards;
}
.fx-bug svg { width: 100%; height: auto; }
.fx-bug .wiggle { transform-origin: 50% 50%; animation: bugWiggle .55s linear infinite; }

/* Big “curtain” (veil) */
@keyframes fxCurtain {
  0% { transform: translateY(-120%); opacity: 0; }
  10% { opacity: .95; }
  55% { transform: translateY(0%); opacity: .9; }
  90% { opacity: .9; }
  100% { transform: translateY(120%); opacity: 0; }
}
.fx-curtain {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(0,0,0,.0), rgba(0,0,0,.18), rgba(0,0,0,.0));
  mix-blend-mode: multiply;
  animation: fxCurtain 9.5s ease forwards;
}

/* Big “pulse” flash */
@keyframes fxPulse {
  0%{ opacity: 0; }
  8%{ opacity: .9; }
  20%{ opacity: .4; }
  35%{ opacity: .85; }
  50%{ opacity: .35; }
  65%{ opacity: .8; }
  80%{ opacity: .25; }
  100%{ opacity: 0; }
}
.fx-flash {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,.95), rgba(255,255,255,0) 68%);
  mix-blend-mode: screen;
  animation: fxPulse 8.5s ease forwards;
}

/* Big “scanlines” (trace/signal) */
@keyframes fxScan {
  0% { transform: translateY(-20%); opacity: 0; }
  10% { opacity: .75; }
  75% { opacity: .65; }
  100% { transform: translateY(20%); opacity: 0; }
}
.fx-scanlines{
  position:absolute;
  inset:-10%;
  background: repeating-linear-gradient(
    180deg,
    rgba(0,0,0,.06) 0px,
    rgba(0,0,0,.06) 2px,
    rgba(255,255,255,0) 6px,
    rgba(255,255,255,0) 12px
  );
  mix-blend-mode:multiply;
  filter: blur(.4px);
  animation: fxScan 9s ease forwards;
}

/* Big “paper fold” polygons */
@keyframes fxFold {
  0% { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); opacity: 0; transform: scale(1.02); }
  12% { opacity: .9; }
  55% { clip-path: polygon(0 0, 100% 0, 72% 55%, 100% 100%, 0 100%, 30% 45%); opacity: .85; }
  100% { clip-path: polygon(0 0, 20% 0, 0 25%); opacity: 0; transform: scale(1.08); }
}
.fx-fold{
  position:absolute;
  inset:0;
  background: linear-gradient(135deg, rgba(255,255,255,.65), rgba(0,0,0,.04));
  mix-blend-mode:multiply;
  animation: fxFold 10s ease forwards;
}

/* Big “ink spill” */
@keyframes fxInk {
  0% { transform: translate(-50%,-50%) scale(0.1); opacity: 0; filter: blur(8px); }
  12% { opacity: .85; }
  70% { transform: translate(-50%,-50%) scale(1.15); opacity: .75; filter: blur(18px); }
  100% { transform: translate(-50%,-50%) scale(1.45); opacity: 0; filter: blur(24px); }
}
.fx-ink{
  position:absolute;
  left:50%;
  top:50%;
  width: 70vmax;
  height: 70vmax;
  border-radius: 999px;
  background: radial-gradient(circle at 40% 35%, rgba(0,0,0,.14), rgba(0,0,0,.03) 55%, rgba(0,0,0,0) 70%);
  mix-blend-mode: multiply;
  animation: fxInk 11s ease forwards;
}

/* Big “glow aura” */
@keyframes fxGlow {
  0% { opacity: 0; filter: blur(14px); transform: scale(0.9); }
  15% { opacity: .9; }
  70% { opacity: .8; filter: blur(24px); transform: scale(1.05); }
  100% { opacity: 0; filter: blur(30px); transform: scale(1.12); }
}
.fx-glow{
  position:absolute;
  inset:-10%;
  background:
    radial-gradient(circle at 25% 30%, rgba(255,255,255,.85), transparent 55%),
    radial-gradient(circle at 70% 60%, rgba(255,255,255,.55), transparent 55%),
    radial-gradient(circle at 50% 50%, rgba(255,255,255,.35), transparent 70%);
  mix-blend-mode: screen;
  animation: fxGlow 10.5s ease forwards;
}

/* Big “slip” wipe */
@keyframes fxWipe {
  0% { transform: translateX(-120%); opacity: 0; }
  10% { opacity: .85; }
  60% { opacity: .75; }
  100% { transform: translateX(120%); opacity: 0; }
}
.fx-wipe{
  position:absolute;
  inset:-10%;
  background: linear-gradient(90deg, rgba(0,0,0,0), rgba(0,0,0,.10), rgba(0,0,0,0));
  mix-blend-mode:multiply;
  animation: fxWipe 9.5s ease forwards;
}

/* Big “break” shards */
@keyframes fxShards {
  0% { opacity: 0; transform: scale(1.02); }
  12% { opacity: .9; }
  70% { opacity: .85; }
  100% { opacity: 0; transform: scale(1.08); }
}
.fx-shards{
  position:absolute;
  inset:0;
  background:
    linear-gradient(25deg, rgba(0,0,0,0) 35%, rgba(0,0,0,.10) 36%, rgba(0,0,0,0) 38%),
    linear-gradient(75deg, rgba(0,0,0,0) 48%, rgba(0,0,0,.08) 49%, rgba(0,0,0,0) 51%),
    linear-gradient(145deg, rgba(0,0,0,0) 58%, rgba(0,0,0,.08) 59%, rgba(0,0,0,0) 61%),
    linear-gradient(210deg, rgba(0,0,0,0) 42%, rgba(0,0,0,.08) 43%, rgba(0,0,0,0) 45%);
  mix-blend-mode:multiply;
  animation: fxShards 9.5s ease forwards;
}

/* Big “mirror” flip */
@keyframes fxMirrorFlip {
  0% { transform: scaleX(1); opacity: 0; }
  12% { opacity: .9; }
  55% { transform: scaleX(-1); opacity: .8; }
  100% { transform: scaleX(1); opacity: 0; }
}
.fx-mirror{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,.55), rgba(0,0,0,.06));
  mix-blend-mode: screen;
  animation: fxMirrorFlip 9s ease forwards;
}
</style>
</head>

<body>
<div id="final">
  <span>https://YOUR_FINAL_URL_HERE</span>
</div>

<div id="inspect">INSPECT</div>
<div id="pastel"></div>
<div id="vignette"></div>
<div id="buttons"></div>

<!-- big effects layer -->
<div id="fx" aria-hidden="true"></div>

<script>
/* ==========================================================
   50 BUTTONS (PEEL placed late/randomish)
   - All buttons trigger BIG, obvious effects (5–15s)
   ========================================================== */

const baseButtons = [
  { label: "Echo",     icon: "fa-volume-high" },
  { label: "Drift",    icon: "fa-water" },
  { label: "Fade",     icon: "fa-circle-half-stroke" },
  { label: "Unlock",   icon: "fa-unlock-keyhole" },
  { label: "Trace",    icon: "fa-pen-fancy" },
  { label: "Veil",     icon: "fa-ghost" },
  { label: "Shift",    icon: "fa-arrows-rotate" },
  { label: "Open",     icon: "fa-door-open" },
  { label: "Thin",     icon: "fa-sliders" },

  { label: "Crack",    icon: "fa-bolt" },
  { label: "Signal",   icon: "fa-tower-cell" },
  { label: "Lift",     icon: "fa-arrow-up" },
  { label: "Ghost",    icon: "fa-moon" },
  { label: "Mirror",   icon: "fa-clone" },
  { label: "Pulse",    icon: "fa-heart-pulse" },
  { label: "Layer",    icon: "fa-layer-group" },
  { label: "Quiet",    icon: "fa-volume-xmark" },
  { label: "Hidden",   icon: "fa-eye-slash" },
  { label: "Seek",     icon: "fa-magnifying-glass" },

  { label: "Bleed",    icon: "fa-droplet" },
  { label: "Blur",     icon: "fa-circle-dot" },
  { label: "Reveal",   icon: "fa-eye" },
  { label: "Cipher",   icon: "fa-shield-halved" },
  { label: "Tone",     icon: "fa-palette" },
  { label: "Mask",     icon: "fa-mask" },
  { label: "Fold",     icon: "fa-square" },
  { label: "Slip",     icon: "fa-right-left" },
  { label: "Soft",     icon: "fa-cloud" },
  { label: "Ink",      icon: "fa-pen-nib" },

  { label: "Mark",     icon: "fa-location-dot" },
  { label: "Shell",    icon: "fa-circle" },
  { label: "Veer",     icon: "fa-turn-up" },
  { label: "Hush",     icon: "fa-hand" },
  { label: "Glow",     icon: "fa-sun" },
  { label: "Break",    icon: "fa-burst" },

  { label: "Terminal", icon: "fa-terminal" },
  { label: "Bug",      icon: "fa-bug" },
  { label: "Network",  icon: "fa-network-wired" },
  { label: "Archive",  icon: "fa-box-archive" },
  { label: "Wave",     icon: "fa-wave-square" },

  { label: "Sliders",  icon: "fa-sliders" },
  { label: "Chart",    icon: "fa-chart-line" },
  { label: "Scissors", icon: "fa-scissors" },
  { label: "Infinity", icon: "fa-infinity" },
  { label: "Rotate",   icon: "fa-rotate" },
  { label: "Blind",    icon: "fa-eye-slash" },
  { label: "Door",     icon: "fa-door-open" },
  { label: "Dot",      icon: "fa-circle-dot" },
];

const peelButton = { label: "Peel", icon: "fa-hand-sparkles" };

/* deterministic “randomish” shuffle */
function mulberry32(seed) {
  return function() {
    let t = seed += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}
function shuffleDeterministic(arr, seed=1337){
  const rnd = mulberry32(seed);
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(rnd() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}
function buildButtons(){
  const shuffled = shuffleDeterministic(baseButtons, 24601);
  const total = 50;

  const trimmed = shuffled.slice(0, total - 1);

  const rnd = mulberry32(9001);
  const peelIndex = 35 + Math.floor(rnd() * 13); // late, “randomish”
  trimmed.splice(peelIndex, 0, peelButton);

  // ensure exactly 50
  while (trimmed.length < 50) trimmed.push({label:"Echo", icon:"fa-volume-high"});
  return trimmed.slice(0, 50);
}
const buttonsData = buildButtons();

/* ==========================================================
   DOM + STATE
   ========================================================== */
const container = document.getElementById("buttons");
const pastel = document.getElementById("pastel");
const inspectEl = document.getElementById("inspect");
const finalEl = document.getElementById("final");
const fx = document.getElementById("fx");

let peelIndexInDom = -1;
let fxRunning = false;

function setVar(name, value) {
  document.documentElement.style.setProperty(name, value);
}
function getVar(name) {
  return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
}

/* Base snapshot for resets */
const baseState = {
  pastel: {
    opacity: getVar("--pastel-opacity"),
    brightness: getVar("--pastel-brightness"),
    saturate: getVar("--pastel-saturate"),
    huerotate: getVar("--pastel-huerotate"),
    blur: getVar("--pastel-blur"),
    contrast: getVar("--pastel-contrast"),
    rotate: getVar("--pastel-rotate"),
    scale: getVar("--pastel-scale"),
    x: getVar("--pastel-x"),
    y: getVar("--pastel-y"),
  },
  inspect: {
    opacity: getVar("--inspect-opacity"),
    brightness: getVar("--inspect-brightness"),
    contrast: getVar("--inspect-contrast"),
    blur: getVar("--inspect-blur"),
    letterspacing: getVar("--inspect-letterspacing"),
  },
  buttons: {
    blur: getVar("--buttons-blur"),
    glow: getVar("--buttons-glow"),
    outline: getVar("--buttons-outline"),
  },
  vignette: {
    opacity: getVar("--vignette-opacity"),
  }
};

function resetAll() {
  setVar("--pastel-opacity", baseState.pastel.opacity);
  setVar("--pastel-brightness", baseState.pastel.brightness);
  setVar("--pastel-saturate", baseState.pastel.saturate);
  setVar("--pastel-huerotate", baseState.pastel.huerotate);
  setVar("--pastel-blur", baseState.pastel.blur);
  setVar("--pastel-contrast", baseState.pastel.contrast);
  setVar("--pastel-rotate", baseState.pastel.rotate);
  setVar("--pastel-scale", baseState.pastel.scale);
  setVar("--pastel-x", baseState.pastel.x);
  setVar("--pastel-y", baseState.pastel.y);

  setVar("--inspect-opacity", baseState.inspect.opacity);
  setVar("--inspect-brightness", baseState.inspect.brightness);
  setVar("--inspect-contrast", baseState.inspect.contrast);
  setVar("--inspect-blur", baseState.inspect.blur);
  setVar("--inspect-letterspacing", baseState.inspect.letterspacing);

  setVar("--buttons-blur", baseState.buttons.blur);
  setVar("--buttons-glow", baseState.buttons.glow);
  setVar("--buttons-outline", baseState.buttons.outline);

  setVar("--vignette-opacity", baseState.vignette.opacity);

  pastel.classList.remove("glitch");
}

/* ==========================================================
   FX OVERLAY HELPERS (BIG, 5–15s)
   ========================================================== */

function clearFX() {
  fx.classList.remove("active");
  fx.innerHTML = "";
}

function disableButtons() {
  container.style.pointerEvents = "none";
}
function enableButtons() {
  container.style.pointerEvents = "auto";
}

function startFX({ label, icon, durationMs }, builder) {
  if (fxRunning) return;
  fxRunning = true;
  disableButtons();

  clearFX();
  fx.classList.add("active");

  // base structure
  const backdrop = document.createElement("div");
  backdrop.className = "fx-backdrop";
  fx.appendChild(backdrop);

  const ring = document.createElement("div");
  ring.className = "fx-ring";
  ring.style.animation = `fxRipple ${Math.max(5000, durationMs)}ms ease forwards`;
  fx.appendChild(ring);

  const title = document.createElement("div");
  title.className = "fx-title";
  title.innerHTML = `
    <div class="word" style="animation: fxFloat 2.2s ease-in-out infinite;">
      <div class="fx-icon"><i class="fa-solid ${icon}"></i></div>
      <div>${label}</div>
    </div>
  `;
  fx.appendChild(title);

  const particles = document.createElement("div");
  particles.className = "fx-particles";
  fx.appendChild(particles);

  builder?.({ backdrop, ring, title, particles });

  setTimeout(() => {
    clearFX();
    resetAll();
    fxRunning = false;
    enableButtons();
  }, durationMs);
}

/* Small deterministic random */
function rnd(seed=12345) {
  const r = mulberry32(seed);
  return () => r();
}
function sprinkleParticles(particles, count, seed=777) {
  const r = rnd(seed);
  for (let i = 0; i < count; i++) {
    const d = document.createElement("div");
    const size = 6 + Math.floor(r()*16);
    d.style.position = "absolute";
    d.style.left = (r()*120 - 10) + "%";
    d.style.top = (r()*120 - 10) + "%";
    d.style.width = size + "px";
    d.style.height = size + "px";
    d.style.borderRadius = "999px";
    d.style.background = r() > .5 ? "rgba(0,0,0,.08)" : "rgba(255,255,255,.85)";
    d.style.filter = "blur(" + (r()*2.2) + "px)";
    d.style.opacity = (0.15 + r()*0.55).toFixed(2);
    d.style.transform = `translateZ(0)`;
    d.style.animation = `fxFloat ${1800 + Math.floor(r()*2200)}ms ease-in-out ${Math.floor(r()*600)}ms infinite`;
    particles.appendChild(d);
  }
}

/* ==========================================================
   BIG ACTIONS FOR EVERY LABEL
   ========================================================== */

function runBigEffect(item) {
  const label = item.label;
  const icon = item.icon;

  // 5–15 seconds
  const D = {
    Echo: 9000,
    Drift: 10000,
    Fade: 9000,
    Unlock: 8000,
    Trace: 9000,
    Veil: 9500,
    Shift: 8000,
    Open: 7000,
    Thin: 9000,
    Crack: 9000,
    Signal: 9000,
    Lift: 8000,
    Ghost: 10000,
    Mirror: 9000,
    Pulse: 8500,
    Layer: 9500,
    Quiet: 7000,
    Hidden: 9000,
    Seek: 8500,
    Bleed: 10000,
    Blur: 10000,
    Reveal: 8500,
    Cipher: 9500,
    Tone: 9000,
    Mask: 9500,
    Fold: 10500,
    Slip: 9500,
    Soft: 10000,
    Ink: 11000,
    Mark: 8000,
    Shell: 8500,
    Veer: 9000,
    Hush: 9000,
    Glow: 10500,
    Break: 9500,
    Terminal: 8500,
    Bug: 12000,
    Network: 9000,
    Archive: 9500,
    Wave: 9000,
    Sliders: 8500,
    Chart: 9000,
    Scissors: 8500,
    Infinity: 8000,
    Rotate: 8500,
    Blind: 9000,
    Door: 8000,
    Dot: 8000,
  }[label] ?? 9000;

  // PEEL is handled elsewhere.
  startFX({ label, icon, durationMs: D }, ({ backdrop, particles }) => {
    sprinkleParticles(particles, 42, label.length * 1000 + 17);

    // Default: subtle blur + contrast to make effect loud
    backdrop.style.background = "rgba(255,255,255,.12)";
    backdrop.style.backdropFilter = "blur(1px)";

    // label-specific BIG visuals
    if (label === "Bug") {
      // Big ladybug crawl across screen
      backdrop.style.background = "rgba(255,255,255,.18)";
      const bug = document.createElement("div");
      bug.className = "fx-bug";
      bug.innerHTML = `
        <div class="wiggle">
          <svg viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <defs>
              <radialGradient id="g" cx="35%" cy="35%" r="70%">
                <stop offset="0%" stop-color="#ff6b6b"/>
                <stop offset="70%" stop-color="#d61f1f"/>
                <stop offset="100%" stop-color="#a10f0f"/>
              </radialGradient>
            </defs>
            <circle cx="110" cy="118" r="70" fill="url(#g)"/>
            <circle cx="110" cy="60" r="38" fill="#111"/>
            <rect x="106" y="46" width="8" height="145" rx="4" fill="#111" opacity="0.9"/>
            <circle cx="85" cy="110" r="14" fill="#111"/>
            <circle cx="140" cy="100" r="12" fill="#111"/>
            <circle cx="80" cy="145" r="11" fill="#111"/>
            <circle cx="150" cy="140" r="13" fill="#111"/>
            <circle cx="110" cy="58" r="5" fill="#fff" opacity="0.25"/>
            <path d="M58 105 C30 92, 28 70, 55 62" stroke="#111" stroke-width="10" stroke-linecap="round" fill="none"/>
            <path d="M162 105 C190 92, 192 70, 165 62" stroke="#111" stroke-width="10" stroke-linecap="round" fill="none"/>
            <path d="M55 140 C26 132, 24 108, 52 100" stroke="#111" stroke-width="10" stroke-linecap="round" fill="none"/>
            <path d="M165 140 C194 132, 196 108, 168 100" stroke="#111" stroke-width="10" stroke-linecap="round" fill="none"/>
          </svg>
        </div>
      `;
      fx.appendChild(bug);
      return;
    }

    if (label === "Veil") {
      const curtain = document.createElement("div");
      curtain.className = "fx-curtain";
      fx.appendChild(curtain);
      return;
    }

    if (label === "Pulse") {
      const flash = document.createElement("div");
      flash.className = "fx-flash";
      fx.appendChild(flash);
      return;
    }

    if (label === "Trace" || label === "Signal") {
      const scan = document.createElement("div");
      scan.className = "fx-scanlines";
      fx.appendChild(scan);
      return;
    }

    if (label === "Fold") {
      const fold = document.createElement("div");
      fold.className = "fx-fold";
      fx.appendChild(fold);
      return;
    }

    if (label === "Ink") {
      const ink = document.createElement("div");
      ink.className = "fx-ink";
      fx.appendChild(ink);
      return;
    }

    if (label === "Glow") {
      const glow = document.createElement("div");
      glow.className = "fx-glow";
      fx.appendChild(glow);
      return;
    }

    if (label === "Slip") {
      const wipe = document.createElement("div");
      wipe.className = "fx-wipe";
      fx.appendChild(wipe);
      return;
    }

    if (label === "Break" || label === "Crack") {
      const shards = document.createElement("div");
      shards.className = "fx-shards";
      fx.appendChild(shards);
      // also shake the whole UI hard for a moment
      document.body.style.animation = "fxShake 1.2s ease 1";
      setTimeout(() => { document.body.style.animation = ""; }, 1200);
      return;
    }

    if (label === "Mirror") {
      const mirror = document.createElement("div");
      mirror.className = "fx-mirror";
      fx.appendChild(mirror);
      return;
    }

    if (label === "Ghost" || label === "Soft") {
      const fog = document.createElement("div");
      fog.className = "fx-fog";
      fx.appendChild(fog);
      return;
    }

    if (label === "Hush" || label === "Quiet") {
      // Big hush: dim everything, slow vignette
      backdrop.style.background = "rgba(255,255,255,.0)";
      setVar("--vignette-opacity", "1");
      setVar("--pastel-saturate", "85%");
      setVar("--pastel-brightness", "98%");
      return;
    }

    if (label === "Hidden" || label === "Blind") {
      // Make INSPECT vanish (very noticeably), then return via reset
      setVar("--inspect-opacity", "0.000");
      setVar("--pastel-contrast", "115%");
      return;
    }

    if (label === "Reveal" || label === "Seek") {
      // Big, obvious “hint” pulse on the real Peel button
      const peelBtn = container.children[peelIndexInDom];
      if (peelBtn) {
        peelBtn.style.transition = "transform .25s ease, box-shadow .25s ease";
        let t = 0;
        const interval = setInterval(() => {
          t++;
          peelBtn.style.transform = t % 2 ? "scale(1.14)" : "scale(1.05)";
          peelBtn.style.boxShadow = t % 2
            ? "0 16px 44px rgba(0,0,0,.18), 0 0 40px rgba(120,120,120,.45)"
            : "0 12px 30px rgba(0,0,0,.15), 0 0 18px rgba(120,120,120,.25)";
        }, 520);
        setTimeout(() => {
          clearInterval(interval);
          peelBtn.style.transform = "";
          peelBtn.style.boxShadow = "";
        }, Math.min(D - 500, 8000));
      }
      return;
    }

    if (label === "Echo") {
      // Big echo waves: multiple rings
      for (let i=0;i<5;i++){
        const r = document.createElement("div");
        r.className = "fx-ring";
        r.style.left = (45 + i*2) + "%";
        r.style.top = (50 + i*1.5) + "%";
        r.style.animation = `fxRipple ${D - i*800}ms ease ${i*450}ms forwards`;
        fx.appendChild(r);
      }
      return;
    }

    if (label === "Drift" || label === "Veer") {
      // Strong drift: move pastel dramatically (then reset)
      setVar("--pastel-x", label === "Veer" ? "36px" : "26px");
      setVar("--pastel-y", label === "Veer" ? "-22px" : "-16px");
      setVar("--pastel-rotate", label === "Veer" ? "6deg" : "3deg");
      setVar("--pastel-scale", "1.03");
      return;
    }

    if (label === "Fade") {
      // Big fade: pastel fades hard, then returns after effect ends
      setVar("--pastel-opacity", "0.35");
      setVar("--pastel-brightness", "120%");
      return;
    }

    if (label === "Unlock" || label === "Door" || label === "Open") {
      // Big “glimpse”: flash final URL lightly and distort pastel
      finalEl.style.opacity = "0.22";
      setTimeout(() => finalEl.style.opacity = "0", 1200);
      setVar("--pastel-contrast", "120%");
      setVar("--pastel-huerotate", "18deg");
      return;
    }

    if (label === "Thin") {
      setVar("--inspect-letterspacing", ".10em");
      setVar("--inspect-opacity", "0.02");
      setVar("--pastel-blur", "1.0px");
      return;
    }

    if (label === "Bleed") {
      setVar("--pastel-saturate", "170%");
      setVar("--pastel-brightness", "118%");
      return;
    }

    if (label === "Blur") {
      setVar("--pastel-blur", "1.6px");
      setVar("--inspect-blur", "1.0px");
      return;
    }

    if (label === "Cipher") {
      // Big cipher: scramble INSPECT for most of the effect
      const original = inspectEl.textContent;
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let alive = true;
      const tick = setInterval(() => {
        if (!alive) return;
        inspectEl.textContent = Array.from({length:7}).map(()=>chars[Math.floor(Math.random()*chars.length)]).join("");
      }, 90);
      setTimeout(() => { alive = false; clearInterval(tick); inspectEl.textContent = original; }, Math.min(D - 400, 9000));
      return;
    }

    if (label === "Tone" || label === "Chart" || label === "Sliders") {
      // Big tone shift: hue rotate + contrast
      setVar("--pastel-huerotate", "38deg");
      setVar("--pastel-contrast", "125%");
      setVar("--pastel-brightness", "120%");
      return;
    }

    if (label === "Mask") {
      setVar("--vignette-opacity", "1");
      setVar("--pastel-brightness", "102%");
      setVar("--pastel-contrast", "112%");
      return;
    }

    if (label === "Layer" || label === "Shell") {
      // Big layer: switch blend mode temporarily + brighten
      const old = pastel.style.mixBlendMode;
      pastel.style.mixBlendMode = "screen";
      setVar("--pastel-brightness", "124%");
      setVar("--pastel-saturate", "140%");
      setTimeout(() => { pastel.style.mixBlendMode = old || "multiply"; }, Math.min(D - 600, 7000));
      return;
    }

    if (label === "Lift") {
      // Lift cards up in a wave for several seconds
      const btns = Array.from(container.querySelectorAll(".button"));
      let alive = true;
      const start = performance.now();
      function wave(t){
        if (!alive) return;
        const phase = (t - start) / 350;
        btns.forEach((b, i) => {
          const y = Math.sin(phase + i*0.35) * 14;
          b.style.transform = `translateY(${-y}px) scale(1.02)`;
        });
        requestAnimationFrame(wave);
      }
      requestAnimationFrame(wave);
      setTimeout(() => {
        alive = false;
        btns.forEach(b => b.style.transform = "");
      }, Math.min(D - 300, 9000));
      return;
    }

    if (label === "Mark" || label === "Archive" || label === "Network" || label === "Terminal") {
      // Big “system” vibe: scanlines + mild shake pulse
      const scan = document.createElement("div");
      scan.className = "fx-scanlines";
      fx.appendChild(scan);
      document.body.style.animation = "fxShake 1s ease 1";
      setTimeout(() => { document.body.style.animation = ""; }, 1000);
      if (label === "Terminal") {
        console.log("%c> inspection channel: live", "font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; color:#666;");
      }
      return;
    }

    if (label === "Infinity" || label === "Rotate") {
      // Big rotation + hue sweep
      setVar("--pastel-rotate", "10deg");
      setVar("--pastel-huerotate", "90deg");
      setVar("--pastel-contrast", "118%");
      return;
    }

    if (label === "Scissors") {
      // Big “cut” swipe across
      const wipe = document.createElement("div");
      wipe.className = "fx-wipe";
      fx.appendChild(wipe);
      setVar("--pastel-opacity", "0.75");
      return;
    }

    if (label === "Wave") {
      // Strong wave: oscillate pastel position for several seconds
      let alive = true;
      const start = performance.now();
      function oscillate(t){
        if (!alive) return;
        const p = (t - start) / 600;
        setVar("--pastel-x", (Math.sin(p) * 18).toFixed(1) + "px");
        setVar("--pastel-y", (Math.cos(p*1.2) * 14).toFixed(1) + "px");
        requestAnimationFrame(oscillate);
      }
      requestAnimationFrame(oscillate);
      setTimeout(() => { alive = false; setVar("--pastel-x","0px"); setVar("--pastel-y","0px"); }, Math.min(D - 300, 9000));
      return;
    }

    if (label === "Dot") {
      // Big dot spotlight: animated “spot” by tweaking vignette opacity
      setVar("--vignette-opacity", "1");
      return;
    }
  });
}

/* ==========================================================
   PEEL ACTION
   - Hide buttons immediately
   - Peel animation
   - Reveal final URL
   ========================================================== */
function peel() {
  // stop any running FX cleanly
  clearFX();
  fxRunning = false;

  // buttons go away
  container.style.opacity = "0";
  container.style.pointerEvents = "none";

  // peel the pastel
  pastel.classList.add("peeling");

  // reveal final
  setTimeout(() => {
    finalEl.style.opacity = "1";
  }, 950);
}

/* ==========================================================
   RENDER BUTTONS
   ========================================================== */
buttonsData.forEach((item, i) => {
  const b = document.createElement("div");
  b.className = "button";
  b.innerHTML = `<i class="fa-solid ${item.icon}"></i>${item.label}`;

  if (item.label === "Peel") peelIndexInDom = i;

  b.onclick = () => {
    if (fxRunning) return;
    b.classList.add("ping");
    setTimeout(() => b.classList.remove("ping"), 450);

    if (item.label === "Peel") {
      peel();
      return;
    }
    runBigEffect(item);
  };

  container.appendChild(b);
});

/* ==========================================================
   DEVTOOLS DETECTION + COMMENT REVEAL + DELAYED BUTTONS
   ========================================================== */
let devtoolsOpened = false;

setInterval(() => {
  const open =
    window.outerWidth - window.innerWidth > 160 ||
    window.outerHeight - window.innerHeight > 160;

  if (open && !devtoolsOpened) {
    devtoolsOpened = true;

    const message = "not everything is meant to be seen";

    // Console reveal
    console.log("%c" + message, "color:#888;font-style:italic;font-size:14px;");

    // Elements reveal (hidden node)
    const note = document.createElement("div");
    note.setAttribute("data-inspection-note", message);
    note.style.display = "none";
    document.body.appendChild(note);

    // After 30s, show buttons
    setTimeout(() => {
      container.style.opacity = "1";
      container.style.pointerEvents = "auto";
    }, 30000);
  }
}, 500);
</script>

</body>
</html>
