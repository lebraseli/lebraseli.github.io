<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Between The Colors</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- not everything is meant to be seen -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
:root{
  --pastel-opacity: 1;
  --pastel-brightness: 110%;
  --pastel-saturate: 110%;
  --pastel-huerotate: 0deg;
  --pastel-blur: 0px;
  --pastel-contrast: 100%;
  --pastel-rotate: 0deg;
  --pastel-scale: 1;
  --pastel-x: 0px;
  --pastel-y: 0px;

  --inspect-opacity: 0.012;
  --inspect-brightness: 99%;
  --inspect-contrast: 101%;
  --inspect-blur: .45px;
  --inspect-letterspacing: .34em;

  --vignette-opacity: 0;
}

html, body {
  margin: 0;
  height: 100%;
  overflow: hidden;
  background: #fdfdfd;
  font-family: system-ui, sans-serif;
}

/* ===== FINAL URL ===== */
#final {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  font-size: 2.8rem;
  font-weight: 650;
  opacity: 0;
  z-index: 1;
  transition: opacity 1.2s ease;
}
#final span { color: #111; }

/* ===== HIDDEN WORD ===== */
#inspect {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  font-size: 16vw;
  font-weight: 900;
  letter-spacing: var(--inspect-letterspacing);
  color: rgb(246,246,246);
  opacity: var(--inspect-opacity);
  mix-blend-mode: difference;
  text-shadow:
    0 0 .6px rgba(0,0,0,.025),
    0 0 1.2px rgba(0,0,0,.015);
  filter:
    blur(var(--inspect-blur))
    contrast(var(--inspect-contrast))
    brightness(var(--inspect-brightness));
  pointer-events: none;
  user-select: none;
  z-index: 2;
}

/* ===== PASTEL WASH ===== */
#pastel {
  position: fixed;
  inset: 0;
  background:
    radial-gradient(circle at 20% 30%, #f7b7d2 0%, transparent 60%),
    radial-gradient(circle at 80% 20%, #b7ccff 0%, transparent 60%),
    radial-gradient(circle at 50% 80%, #fff0b3 0%, transparent 60%),
    linear-gradient(120deg, rgba(255,200,210,.5), rgba(200,210,255,.5));
  opacity: var(--pastel-opacity);
  filter:
    brightness(var(--pastel-brightness))
    saturate(var(--pastel-saturate))
    hue-rotate(var(--pastel-huerotate))
    blur(var(--pastel-blur))
    contrast(var(--pastel-contrast));
  mix-blend-mode: multiply;
  z-index: 5;
  transition: opacity 1.2s ease, filter .6s ease;
  transform:
    translate(var(--pastel-x), var(--pastel-y))
    rotate(var(--pastel-rotate))
    scale(var(--pastel-scale));
  transform-origin: 20% 20%;
  will-change: transform, clip-path, opacity, filter;
}
#pastel::after{
  content:"";
  position:absolute;
  inset:-10%;
  pointer-events:none;
  opacity:0;
  background: radial-gradient(closest-side, rgba(0,0,0,.12), transparent 65%);
  mix-blend-mode:multiply;
  filter: blur(12px);
  transition: opacity .4s ease;
}
#pastel.peeling { animation: peelOff 1.25s cubic-bezier(.2,.9,.2,1) forwards; }
#pastel.peeling::after{ opacity: .75; }
@keyframes peelOff {
  0%   { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); transform: translate(0,0) rotate(0) scale(1); opacity: 1; }
  35%  { clip-path: polygon(0 0, 100% 0, 94% 72%, 62% 92%, 25% 88%, 0 74%); transform: translate(-8px,-6px) rotate(-3deg) scale(1.02); opacity: 1; }
  70%  { clip-path: polygon(0 0, 78% 0, 62% 40%, 48% 55%, 20% 62%, 0 48%); transform: translate(-28px,-22px) rotate(-9deg) scale(1.04); opacity: .55; }
  100% { clip-path: polygon(0 0, 30% 0, 18% 18%, 10% 25%, 0 22%); transform: translate(-80px,-70px) rotate(-18deg) scale(1.06); opacity: 0; }
}

/* ===== VIGNETTE ===== */
#vignette {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 7;
  opacity: var(--vignette-opacity);
  transition: opacity .35s ease;
  background:
    radial-gradient(circle at 50% 50%, rgba(255,255,255,0) 45%, rgba(0,0,0,.18) 85%, rgba(0,0,0,.30) 100%);
  mix-blend-mode: multiply;
}

/* ===== BUTTON GRID ===== */
#buttons {
  position: fixed;
  inset: 0;
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  grid-template-rows: repeat(5, 1fr);
  gap: 12px;
  padding: 32px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s ease;
  z-index: 10;
}

.button {
  background: rgba(255,255,255,.75);
  border-radius: 18px;
  backdrop-filter: blur(12px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: .7rem;
  cursor: pointer;
  box-shadow: 0 12px 30px rgba(0,0,0,.15);
  transition: transform .22s ease, box-shadow .22s ease;
  user-select: none;
}
.button:hover { transform: scale(1.08); }
.button i { font-size: 1.4rem; margin-bottom: 6px; }
.button.ping { animation: ping .35s ease; }
@keyframes ping { 0%{transform:scale(1)} 50%{transform:scale(1.07)} 100%{transform:scale(1)} }

/* ===== FX OVERLAY ===== */
#fx {
  position: fixed;
  inset: 0;
  z-index: 30;
  pointer-events: none;
  opacity: 0;
  transition: opacity .15s ease;
}
#fx.active { opacity: 1; }

.fx-center {
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
}

/* We keep fx-card styles in case you want them later, but we NO LONGER render it. */
.fx-card {
  border-radius: 28px;
  background: rgba(255,255,255,.60);
  backdrop-filter: blur(18px);
  box-shadow: 0 24px 80px rgba(0,0,0,.18);
  padding: 18px 22px;
  display: inline-flex;
  align-items: center;
  gap: 14px;
  transform: translateZ(0);
  max-width: min(820px, 90vw);
}
.fx-card .ico { font-size: clamp(28px, 6vw, 62px); }
.fx-card .txt {
  font-weight: 900;
  letter-spacing: .10em;
  font-size: clamp(28px, 7vw, 92px);
  text-transform: uppercase;
}

/* ===== UNIQUE FX KEYFRAMES ===== */
@keyframes echoRings {
  0%{ transform: translate(-50%,-50%) scale(.05); opacity: .9; }
  80%{ opacity: .25; }
  100%{ transform: translate(-50%,-50%) scale(2.3); opacity: 0; }
}
@keyframes fadeWash {
  0%{ opacity: 0; }
  20%{ opacity: .92; }
  60%{ opacity: .92; }
  100%{ opacity: 0; }
}
@keyframes radarSweep {
  0%{ transform: translate(-50%,-50%) rotate(0deg); opacity:.0; }
  10%{ opacity:.75; }
  90%{ opacity:.75; }
  100%{ transform: translate(-50%,-50%) rotate(360deg); opacity:0; }
}
@keyframes curtainSlide {
  0%{ transform: translateY(-120%); opacity:0; }
  12%{ opacity:.92; }
  55%{ transform: translateY(0%); opacity:.9; }
  100%{ transform: translateY(120%); opacity:0; }
}
@keyframes doorSwing {
  0%{ transform: perspective(900px) rotateY(0deg); }
  25%{ transform: perspective(900px) rotateY(-65deg); }
  70%{ transform: perspective(900px) rotateY(-65deg); }
  100%{ transform: perspective(900px) rotateY(0deg); }
}
@keyframes crackZap {
  0%{ opacity:0; transform: scale(1.02); }
  15%{ opacity:.85; }
  75%{ opacity:.75; }
  100%{ opacity:0; transform: scale(1.08); }
}
@keyframes fogRoll {
  0%{ transform: translateX(-25%) scale(1.15); opacity:0; }
  10%{ opacity:.75; }
  80%{ opacity:.65; }
  100%{ transform: translateX(25%) scale(1.15); opacity:0; }
}
@keyframes pulseFlash {
  0%{ opacity: 0; }
  10%{ opacity: .9; }
  22%{ opacity: .2; }
  35%{ opacity: .85; }
  55%{ opacity: .25; }
  72%{ opacity: .75; }
  100%{ opacity: 0; }
}
@keyframes matrixRain {
  0%{ transform: translateY(-18%); opacity:0; }
  10%{ opacity:.95; }
  90%{ opacity:.75; }
  100%{ transform: translateY(18%); opacity:0; }
}
@keyframes inkBloom {
  0%{ transform: translate(-50%,-50%) scale(.08); opacity:0; filter: blur(10px); }
  12%{ opacity:.85; }
  75%{ opacity:.75; filter: blur(18px); transform: translate(-50%,-50%) scale(1.18); }
  100%{ opacity:0; filter: blur(26px); transform: translate(-50%,-50%) scale(1.45); }
}
@keyframes foldCut {
  0%{ clip-path: polygon(0 0,100% 0,100% 100%,0 100%); opacity:0; }
  12%{ opacity:.9; }
  55%{ clip-path: polygon(0 0,100% 0,70% 55%,100% 100%,0 100%,30% 45%); opacity:.85; }
  100%{ clip-path: polygon(0 0,20% 0,0 25%); opacity:0; }
}
@keyframes bokehDrift {
  0%{ transform: translateY(10%); opacity:0; }
  15%{ opacity:.8; }
  85%{ opacity:.7; }
  100%{ transform: translateY(-10%); opacity:0; }
}
@keyframes wipeSlip {
  0%{ transform: translateX(-120%); opacity:0; }
  12%{ opacity:.85; }
  70%{ opacity:.75; }
  100%{ transform: translateX(120%); opacity:0; }
}
@keyframes shardsBreak {
  0%{ opacity:0; transform: scale(1.02); }
  12%{ opacity:.9; }
  80%{ opacity:.8; }
  100%{ opacity:0; transform: scale(1.08); }
}
@keyframes mirrorFlip {
  0%{ transform: scaleX(1); opacity:0; }
  12%{ opacity:.9; }
  60%{ transform: scaleX(-1); opacity:.85; }
  100%{ transform: scaleX(1); opacity:0; }
}
@keyframes waveSine {
  0%{ transform: translateX(-10%); opacity:0; }
  12%{ opacity:.85; }
  88%{ opacity:.75; }
  100%{ transform: translateX(10%); opacity:0; }
}
@keyframes chartDraw {
  0%{ stroke-dashoffset: 1100; opacity:0; }
  10%{ opacity:.9; }
  85%{ opacity:.9; }
  100%{ stroke-dashoffset: 0; opacity:0; }
}
@keyframes terminalType {
  0%{ opacity:0; transform: translateY(10px); }
  10%{ opacity:.95; transform: translateY(0px); }
  85%{ opacity:.95; }
  100%{ opacity:0; }
}
@keyframes compassSpin {
  0%{ transform: translate(-50%,-50%) rotate(0deg); opacity:0; }
  10%{ opacity:.9; }
  90%{ opacity:.85; }
  100%{ transform: translate(-50%,-50%) rotate(720deg); opacity:0; }
}
@keyframes stampMark {
  0%{ transform: translate(-50%,-50%) scale(0.2) rotate(-12deg); opacity:0; }
  12%{ opacity:.9; transform: translate(-50%,-50%) scale(1.05) rotate(2deg); }
  60%{ opacity:.9; }
  100%{ opacity:0; transform: translate(-50%,-50%) scale(1.2) rotate(6deg); }
}
@keyframes spotlightSeek {
  0%{ opacity:0; transform: translate(-50%,-50%) scale(.6); }
  15%{ opacity:.9; }
  85%{ opacity:.85; }
  100%{ opacity:0; transform: translate(-50%,-50%) scale(1.05); }
}

@keyframes bugPro {
  0%   { transform: translate(-20vw, 78vh) rotate(-8deg) scale(.92); opacity: 0; }
  10%  { opacity: 1; }
  26%  { transform: translate(18vw, 60vh) rotate(6deg)  scale(1.00); }
  44%  { transform: translate(48vw, 52vh) rotate(-3deg) scale(1.02); }
  55%  { transform: translate(52vw, 50vh) rotate(2deg)  scale(1.02); }
  64%  { transform: translate(62vw, 46vh) rotate(-2deg) scale(1.03); }
  80%  { transform: translate(88vw, 40vh) rotate(5deg)  scale(1.02); }
  100% { transform: translate(120vw, 32vh) rotate(2deg) scale(.98); opacity: 1; }
}
</style>
</head>

<body>
<div id="final"><span>https://YOUR_FINAL_URL_HERE</span></div>
<div id="inspect">INSPECT</div>
<div id="pastel"></div>
<div id="vignette"></div>
<div id="buttons"></div>
<div id="fx" aria-hidden="true"></div>

<script>
/* ==========================================================
   BUTTONS: PEEL is late/randomish, stable per refresh
   Each button triggers a DISTINCT effect (no reuse shortcuts).
   Each effect lasts 3–7 seconds.
   ========================================================== */

const baseButtons = [
  { label:"Echo",     icon:"fa-volume-high" },
  { label:"Drift",    icon:"fa-water" },
  { label:"Fade",     icon:"fa-circle-half-stroke" },
  { label:"Unlock",   icon:"fa-unlock-keyhole" },
  { label:"Trace",    icon:"fa-pen-fancy" },
  { label:"Veil",     icon:"fa-ghost" },
  { label:"Shift",    icon:"fa-arrows-rotate" },
  { label:"Open",     icon:"fa-door-open" },
  { label:"Thin",     icon:"fa-minimize" },

  { label:"Crack",    icon:"fa-bolt" },
  { label:"Signal",   icon:"fa-tower-cell" },
  { label:"Lift",     icon:"fa-arrow-up" },
  { label:"Ghost",    icon:"fa-moon" },
  { label:"Mirror",   icon:"fa-clone" },
  { label:"Pulse",    icon:"fa-heart-pulse" },
  { label:"Layer",    icon:"fa-layer-group" },
  { label:"Quiet",    icon:"fa-volume-xmark" },
  { label:"Hidden",   icon:"fa-eye-slash" },
  { label:"Seek",     icon:"fa-magnifying-glass" },

  { label:"Bleed",    icon:"fa-droplet" },
  { label:"Blur",     icon:"fa-circle-dot" },
  { label:"Reveal",   icon:"fa-eye" },
  { label:"Cipher",   icon:"fa-shield-halved" },
  { label:"Tone",     icon:"fa-palette" },
  { label:"Mask",     icon:"fa-mask" },
  { label:"Fold",     icon:"fa-square" },
  { label:"Slip",     icon:"fa-right-left" },
  { label:"Soft",     icon:"fa-cloud" },
  { label:"Ink",      icon:"fa-pen-nib" },

  { label:"Mark",     icon:"fa-stamp" },
  { label:"Shell",    icon:"fa-spiral" },         // FA 6: spiral exists in pro; fallback below if missing
  { label:"Veer",     icon:"fa-compass" },
  { label:"Hush",     icon:"fa-hand" },
  { label:"Glow",     icon:"fa-sun" },
  { label:"Break",    icon:"fa-burst" },

  { label:"Terminal", icon:"fa-terminal" },
  { label:"Bug",      icon:"fa-bug" },
  { label:"Network",  icon:"fa-network-wired" },
  { label:"Archive",  icon:"fa-box-archive" },
  { label:"Wave",     icon:"fa-wave-square" },

  { label:"Sliders",  icon:"fa-sliders" },
  { label:"Chart",    icon:"fa-chart-line" },
  { label:"Scissors", icon:"fa-scissors" },
  { label:"Infinity", icon:"fa-infinity" },
  { label:"Rotate",   icon:"fa-rotate" },
  { label:"Blind",    icon:"fa-eye-slash" },
  { label:"Door",     icon:"fa-door-open" },
  { label:"Dot",      icon:"fa-circle-dot" },
];

const peelButton = { label:"Peel", icon:"fa-hand-sparkles" };

/* deterministic shuffle */
function mulberry32(seed) {
  return function() {
    let t = seed += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}
function shuffleDeterministic(arr, seed){
  const rnd = mulberry32(seed);
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(rnd() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}
function buildButtons(){
  const shuffled = shuffleDeterministic(baseButtons, 24601);
  const trimmed = shuffled.slice(0, 49);
  const rnd = mulberry32(9001);
  const peelIndex = 35 + Math.floor(rnd() * 13); // late-ish
  trimmed.splice(peelIndex, 0, peelButton);
  return trimmed.slice(0, 50);
}
const buttonsData = buildButtons();

/* ==========================================================
   DOM + Helpers
   ========================================================== */
const container = document.getElementById("buttons");
const pastel = document.getElementById("pastel");
const inspectEl = document.getElementById("inspect");
const finalEl = document.getElementById("final");
const fx = document.getElementById("fx");

let fxRunning = false;
let peelIndexInDom = -1;

function setVar(name, value){ document.documentElement.style.setProperty(name, value); }
function getVar(name){ return getComputedStyle(document.documentElement).getPropertyValue(name).trim(); }

const baseState = {
  pastel: {
    opacity: getVar("--pastel-opacity"),
    brightness: getVar("--pastel-brightness"),
    saturate: getVar("--pastel-saturate"),
    huerotate: getVar("--pastel-huerotate"),
    blur: getVar("--pastel-blur"),
    contrast: getVar("--pastel-contrast"),
    rotate: getVar("--pastel-rotate"),
    scale: getVar("--pastel-scale"),
    x: getVar("--pastel-x"),
    y: getVar("--pastel-y"),
  },
  inspect: {
    opacity: getVar("--inspect-opacity"),
    brightness: getVar("--inspect-brightness"),
    contrast: getVar("--inspect-contrast"),
    blur: getVar("--inspect-blur"),
    letterspacing: getVar("--inspect-letterspacing"),
  },
  vignette: { opacity: getVar("--vignette-opacity") }
};

function resetAll(){
  setVar("--pastel-opacity", baseState.pastel.opacity);
  setVar("--pastel-brightness", baseState.pastel.brightness);
  setVar("--pastel-saturate", baseState.pastel.saturate);
  setVar("--pastel-huerotate", baseState.pastel.huerotate);
  setVar("--pastel-blur", baseState.pastel.blur);
  setVar("--pastel-contrast", baseState.pastel.contrast);
  setVar("--pastel-rotate", baseState.pastel.rotate);
  setVar("--pastel-scale", baseState.pastel.scale);
  setVar("--pastel-x", baseState.pastel.x);
  setVar("--pastel-y", baseState.pastel.y);

  setVar("--inspect-opacity", baseState.inspect.opacity);
  setVar("--inspect-brightness", baseState.inspect.brightness);
  setVar("--inspect-contrast", baseState.inspect.contrast);
  setVar("--inspect-blur", baseState.inspect.blur);
  setVar("--inspect-letterspacing", baseState.inspect.letterspacing);

  setVar("--vignette-opacity", baseState.vignette.opacity);

  document.body.style.animation = "";
}

function clearFX(){
  fx.classList.remove("active");
  fx.innerHTML = "";
}

function disableButtons(){ container.style.pointerEvents = "none"; }
function enableButtons(){ container.style.pointerEvents = "auto"; }

/* duration strictly 3–7s */
function dur(label){
  const map = {
    Echo: 4200, Drift: 5600, Fade: 4800, Unlock: 3800, Trace: 5200,
    Veil: 6100, Shift: 4300, Open: 3900, Thin: 4600, Crack: 5200,
    Signal: 4700, Lift: 6000, Ghost: 6400, Mirror: 4100, Pulse: 4300,
    Layer: 5400, Quiet: 3600, Hidden: 5000, Seek: 5200, Bleed: 6400,
    Blur: 5200, Reveal: 4000, Cipher: 6500, Tone: 4200, Mask: 5400,
    Fold: 6200, Slip: 4100, Soft: 6000, Ink: 6600, Mark: 4300,
    Shell: 5200, Veer: 4100, Hush: 5300, Glow: 6500, Break: 5200,
    Terminal: 6000, Bug: 6500, Network: 5200, Archive: 5000, Wave: 5200,
    Sliders: 4200, Chart: 5200, Scissors: 4000, Infinity: 3800, Rotate: 4300,
    Blind: 5200, Door: 4100, Dot: 4200
  };
  return map[label] ?? 4800;
}

/* ==========================================================
   IMPORTANT CHANGE:
   No more center label card at all — ONLY the effect.
   ========================================================== */
function startFX(label, icon, build){
  if (fxRunning) return;
  fxRunning = true;
  disableButtons();
  clearFX();
  fx.classList.add("active");

  // NO fxCard() — removed per request.
  build?.();

  const ms = dur(label);
  setTimeout(() => {
    clearFX();
    resetAll();
    fxRunning = false;
    enableButtons();
  }, ms);
}

/* ==========================================================
   DISTINCT EFFECTS (each one unique)
   ========================================================== */
function effectEcho(){
  startFX("Echo","fa-volume-high",() => {
    for (let i=0;i<6;i++){
      const ring = document.createElement("div");
      ring.style.position = "absolute";
      ring.style.left = "50%";
      ring.style.top = "50%";
      ring.style.width = "22vmin";
      ring.style.height = "22vmin";
      ring.style.borderRadius = "999px";
      ring.style.border = "6px solid rgba(0,0,0,.12)";
      ring.style.transform = "translate(-50%,-50%) scale(.05)";
      ring.style.animation = `echoRings ${dur("Echo") - i*250}ms ease ${i*120}ms forwards`;
      ring.style.filter = "blur(.2px)";
      fx.appendChild(ring);
    }
  });
}

function effectDrift(){
  startFX("Drift","fa-water",() => {
    const layer = document.createElement("div");
    layer.style.position="absolute"; layer.style.inset="-20%";
    layer.style.background = `
      radial-gradient(circle at 20% 30%, rgba(255,255,255,.9), transparent 55%),
      radial-gradient(circle at 75% 35%, rgba(255,255,255,.65), transparent 55%),
      radial-gradient(circle at 45% 75%, rgba(255,255,255,.55), transparent 60%)
    `;
    layer.style.mixBlendMode="screen";
    layer.style.filter="blur(26px)";
    layer.style.animation = `fogRoll ${dur("Drift")}ms ease forwards`;
    fx.appendChild(layer);

    setVar("--pastel-x","20px");
    setVar("--pastel-y","-14px");
    setVar("--pastel-rotate","2.8deg");
    setVar("--pastel-scale","1.03");
  });
}

function effectFade(){
  startFX("Fade","fa-circle-half-stroke",() => {
    const wash = document.createElement("div");
    wash.style.position="absolute"; wash.style.inset=0;
    wash.style.background="rgba(255,255,255,1)";
    wash.style.animation = `fadeWash ${dur("Fade")}ms ease forwards`;
    wash.style.mixBlendMode="screen";
    fx.appendChild(wash);
    setVar("--pastel-opacity","0.35");
  });
}

function effectUnlock(){
  startFX("Unlock","fa-unlock-keyhole",() => {
    const lock = document.createElement("div");
    lock.style.position="absolute";
    lock.style.left="50%"; lock.style.top="50%";
    lock.style.transform="translate(-50%,-50%)";
    lock.style.fontSize="min(34vmin,260px)";
    lock.style.filter="drop-shadow(0 20px 24px rgba(0,0,0,.22))";
    lock.innerHTML = `<i class="fa-solid fa-lock"></i>`;
    fx.appendChild(lock);

    lock.animate([
      { transform:"translate(-50%,-50%) rotate(0deg) scale(1)", opacity: 0.0 },
      { transform:"translate(-50%,-50%) rotate(0deg) scale(1.05)", opacity: 1.0, offset: 0.18 },
      { transform:"translate(-50%,-50%) rotate(-12deg) scale(1.08)", opacity: 1.0, offset: 0.55 },
      { transform:"translate(-50%,-50%) rotate(8deg) scale(1.02)", opacity: .9, offset: 0.80 },
      { transform:"translate(-50%,-50%) rotate(0deg) scale(.9)", opacity: 0.0 }
    ], { duration: dur("Unlock"), easing:"cubic-bezier(.2,.9,.2,1)" });

    setVar("--pastel-brightness","125%");
    setVar("--pastel-contrast","120%");
  });
}

function effectTrace(){
  startFX("Trace","fa-pen-fancy",() => {
    const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svg.setAttribute("viewBox","0 0 1000 600");
    svg.style.position="absolute";
    svg.style.inset="0";
    svg.style.width="100%";
    svg.style.height="100%";
    svg.style.filter="drop-shadow(0 18px 22px rgba(0,0,0,.12))";
    svg.style.opacity="0.95";
    svg.innerHTML = `
      <path d="M40,430 C160,120 310,520 430,240 C520,30 710,90 790,250 C870,420 950,340 980,170"
            fill="none" stroke="rgba(0,0,0,.18)" stroke-width="14" stroke-linecap="round"
            stroke-dasharray="1400" stroke-dashoffset="1400"/>
    `;
    fx.appendChild(svg);
    const path = svg.querySelector("path");
    path.animate(
      [{ strokeDashoffset: 1400, opacity: 0.0 }, { strokeDashoffset: 0, opacity: 1.0, offset: 0.75 }, { strokeDashoffset: 0, opacity: 0.0 }],
      { duration: dur("Trace"), easing:"cubic-bezier(.2,.9,.2,1)" }
    );
  });
}

function effectVeil(){
  startFX("Veil","fa-ghost",() => {
    const curtain = document.createElement("div");
    curtain.style.position="absolute"; curtain.style.inset=0;
    curtain.style.background="linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.18), rgba(0,0,0,0))";
    curtain.style.mixBlendMode="multiply";
    curtain.style.animation = `curtainSlide ${dur("Veil")}ms ease forwards`;
    fx.appendChild(curtain);
    setVar("--vignette-opacity","1");
  });
}

function effectShift(){
  startFX("Shift","fa-arrows-rotate",() => {
    const overlay = document.createElement("div");
    overlay.style.position="absolute"; overlay.style.inset=0;
    overlay.style.background = `
      conic-gradient(from 0deg at 50% 50%,
        rgba(255,255,255,.0), rgba(0,0,0,.10), rgba(255,255,255,.0),
        rgba(0,0,0,.08), rgba(255,255,255,.0)
      )
    `;
    overlay.style.mixBlendMode="multiply";
    overlay.style.filter="blur(2px)";
    fx.appendChild(overlay);

    setVar("--pastel-huerotate","65deg");
    setVar("--pastel-contrast","125%");
    setVar("--pastel-brightness","120%");
  });
}

function effectOpen(){
  startFX("Open","fa-door-open",() => {
    const door = document.createElement("div");
    door.style.position="absolute";
    door.style.left="50%"; door.style.top="50%";
    door.style.width="min(60vmin,520px)";
    door.style.height="min(70vmin,600px)";
    door.style.transform="translate(-50%,-50%)";
    door.style.transformOrigin="left center";
    door.style.borderRadius="18px";
    door.style.background="rgba(0,0,0,.10)";
    door.style.boxShadow="0 28px 90px rgba(0,0,0,.18)";
    door.style.backdropFilter="blur(6px)";
    door.style.animation = `doorSwing ${dur("Open")}ms cubic-bezier(.2,.9,.2,1) forwards`;
    fx.appendChild(door);

    const gap = document.createElement("div");
    gap.style.position="absolute";
    gap.style.left="50%"; gap.style.top="50%";
    gap.style.transform="translate(-50%,-50%)";
    gap.style.width="min(60vmin,520px)";
    gap.style.height="min(70vmin,600px)";
    gap.style.borderRadius="18px";
    gap.style.background="radial-gradient(circle at 55% 50%, rgba(255,255,255,.9), rgba(255,255,255,0) 60%)";
    gap.style.mixBlendMode="screen";
    gap.style.opacity=".0";
    fx.appendChild(gap);

    gap.animate([{opacity:0},{opacity:.95,offset:.25},{opacity:.7,offset:.7},{opacity:0}],{duration:dur("Open"),easing:"ease"});
    finalEl.style.opacity="0.18";
    setTimeout(()=>finalEl.style.opacity="0", 1400);
  });
}

function effectThin(){
  startFX("Thin","fa-minimize",() => {
    inspectEl.animate(
      [
        { letterSpacing: getComputedStyle(inspectEl).letterSpacing, transform:"scaleX(1)" },
        { letterSpacing: "0.02em", transform:"scaleX(.55)", offset: .35 },
        { letterSpacing: "0.02em", transform:"scaleX(.55)", offset: .75 },
        { letterSpacing: getComputedStyle(inspectEl).letterSpacing, transform:"scaleX(1)" }
      ],
      { duration: dur("Thin"), easing:"cubic-bezier(.2,.9,.2,1)" }
    );
    setVar("--inspect-opacity","0.03");
    setVar("--inspect-contrast","112%");
  });
}

function effectCrack(){
  startFX("Crack","fa-bolt",() => {
    const shards = document.createElement("div");
    shards.style.position="absolute"; shards.style.inset=0;
    shards.style.background = `
      linear-gradient(25deg, rgba(0,0,0,0) 35%, rgba(0,0,0,.12) 36%, rgba(0,0,0,0) 38%),
      linear-gradient(75deg, rgba(0,0,0,0) 48%, rgba(0,0,0,.10) 49%, rgba(0,0,0,0) 51%),
      linear-gradient(145deg, rgba(0,0,0,0) 58%, rgba(0,0,0,.10) 59%, rgba(0,0,0,0) 61%),
      linear-gradient(210deg, rgba(0,0,0,0) 42%, rgba(0,0,0,.10) 43%, rgba(0,0,0,0) 45%)
    `;
    shards.style.mixBlendMode="multiply";
    shards.style.animation = `crackZap ${dur("Crack")}ms ease forwards`;
    fx.appendChild(shards);

    document.body.style.animation = "fxShake 0.9s ease 1";
    setTimeout(()=>document.body.style.animation="", 900);
  });
}

function effectSignal(){
  startFX("Signal","fa-tower-cell",() => {
    const radar = document.createElement("div");
    radar.style.position="absolute";
    radar.style.left="50%"; radar.style.top="50%";
    radar.style.width="min(82vmin,820px)";
    radar.style.height="min(82vmin,820px)";
    radar.style.borderRadius="999px";
    radar.style.transform="translate(-50%,-50%)";
    radar.style.background = `
      radial-gradient(circle at 50% 50%, rgba(0,0,0,.12) 1px, transparent 2px),
      radial-gradient(circle at 50% 50%, transparent 0 18%, rgba(0,0,0,.08) 18% 19%, transparent 19% 36%, rgba(0,0,0,.06) 36% 37%, transparent 37% 55%, rgba(0,0,0,.05) 55% 56%, transparent 56% 75%, rgba(0,0,0,.04) 75% 76%, transparent 76% 100%),
      conic-gradient(from 0deg at 50% 50%, rgba(0,0,0,.18), rgba(0,0,0,0) 60deg, rgba(0,0,0,0) 360deg)
    `;
    radar.style.mixBlendMode="multiply";
    radar.style.filter="blur(.2px)";
    radar.style.animation = `radarSweep ${dur("Signal")}ms linear forwards`;
    fx.appendChild(radar);
  });
}

function effectLift(){
  startFX("Lift","fa-arrow-up",() => {
    const btns = Array.from(container.querySelectorAll(".button"));
    let alive = true;
    const start = performance.now();
    const ms = dur("Lift");
    function tick(t){
      if (!alive) return;
      const p = (t - start) / 250;
      btns.forEach((b,i) => {
        const y = Math.sin(p + i*0.33) * 18;
        const s = 1.0 + (Math.cos(p + i*0.2)*0.02);
        b.style.transform = `translateY(${-y}px) scale(${s.toFixed(3)})`;
        b.style.boxShadow = `0 16px 50px rgba(0,0,0,.12)`;
      });
      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);
    setTimeout(()=>{ alive=false; btns.forEach(b=>{ b.style.transform=""; b.style.boxShadow=""; }); }, ms);
  });
}

function effectGhost(){
  startFX("Ghost","fa-moon",() => {
    const fog = document.createElement("div");
    fog.style.position="absolute"; fog.style.inset="-25%";
    fog.style.background = `
      radial-gradient(circle at 20% 30%, rgba(255,255,255,.85), transparent 60%),
      radial-gradient(circle at 70% 70%, rgba(255,255,255,.65), transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(255,255,255,.50), transparent 72%)
    `;
    fog.style.mixBlendMode="screen";
    fog.style.filter="blur(28px)";
    fog.style.animation = `fogRoll ${dur("Ghost")}ms ease forwards`;
    fx.appendChild(fog);
  });
}

function effectMirror(){
  startFX("Mirror","fa-clone",() => {
    const pane = document.createElement("div");
    pane.style.position="absolute"; pane.style.inset=0;
    pane.style.background = "radial-gradient(circle at 50% 50%, rgba(255,255,255,.55), rgba(0,0,0,.06))";
    pane.style.mixBlendMode="screen";
    pane.style.animation = `mirrorFlip ${dur("Mirror")}ms ease forwards`;
    fx.appendChild(pane);
  });
}

function effectPulse(){
  startFX("Pulse","fa-heart-pulse",() => {
    const flash = document.createElement("div");
    flash.style.position="absolute"; flash.style.inset=0;
    flash.style.background="radial-gradient(circle at 50% 50%, rgba(255,255,255,.95), rgba(255,255,255,0) 68%)";
    flash.style.mixBlendMode="screen";
    flash.style.animation = `pulseFlash ${dur("Pulse")}ms ease forwards`;
    fx.appendChild(flash);
  });
}

function effectLayer(){
  startFX("Layer","fa-layer-group",() => {
    for (let i=0;i<7;i++){
      const sheet = document.createElement("div");
      sheet.style.position="absolute";
      sheet.style.left = "-10%";
      sheet.style.top = (10 + i*10) + "%";
      sheet.style.width = "120%";
      sheet.style.height = "10%";
      sheet.style.borderRadius = "18px";
      sheet.style.background = `rgba(0,0,0,${0.03 + i*0.01})`;
      sheet.style.mixBlendMode = "multiply";
      sheet.animate(
        [
          { transform: "translateX(-120%)", opacity: 0 },
          { transform: "translateX(0%)", opacity: 0.9, offset: 0.22 },
          { transform: "translateX(0%)", opacity: 0.9, offset: 0.72 },
          { transform: "translateX(120%)", opacity: 0 }
        ],
        { duration: dur("Layer"), easing:"cubic-bezier(.2,.9,.2,1)", delay: i*65 }
      );
      fx.appendChild(sheet);
    }
  });
}

function effectQuiet(){
  startFX("Quiet","fa-volume-xmark",() => {
    setVar("--vignette-opacity","1");
    setVar("--pastel-saturate","85%");
    setVar("--pastel-brightness","98%");
    const wash = document.createElement("div");
    wash.style.position="absolute"; wash.style.inset=0;
    wash.style.background="rgba(255,255,255,.65)";
    wash.style.mixBlendMode="screen";
    wash.style.animation=`fadeWash ${dur("Quiet")}ms ease forwards`;
    fx.appendChild(wash);
  });
}

function effectHidden(){
  startFX("Hidden","fa-eye-slash",() => {
    container.animate([{opacity:1},{opacity:.05},{opacity:.05},{opacity:1}],{duration:dur("Hidden"),easing:"ease"});
    setVar("--inspect-opacity","0.000");
  });
}

function effectSeek(){
  startFX("Seek","fa-magnifying-glass",() => {
    const spot = document.createElement("div");
    spot.style.position="absolute";
    spot.style.left="50%";
    spot.style.top="50%";
    spot.style.width="min(50vmin,520px)";
    spot.style.height="min(50vmin,520px)";
    spot.style.borderRadius="999px";
    spot.style.background="radial-gradient(circle at 50% 50%, rgba(255,255,255,.95), rgba(255,255,255,0) 68%)";
    spot.style.mixBlendMode="screen";
    spot.style.filter="blur(2px)";
    spot.style.animation=`spotlightSeek ${dur("Seek")}ms ease forwards`;
    fx.appendChild(spot);

    const peelBtn = container.children[peelIndexInDom];
    if (peelBtn){
      const rect = peelBtn.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      spot.animate(
        [
          { transform:"translate(-50%,-50%) translate(-320px,-180px) scale(.75)" },
          { transform:"translate(-50%,-50%) translate(220px,-60px) scale(.85)", offset: .35 },
          { transform:"translate(-50%,-50%) translate(-40px,200px) scale(.90)", offset: .65 },
          { transform:`translate(-50%,-50%) translate(${cx - window.innerWidth/2}px, ${cy - window.innerHeight/2}px) scale(1.0)` }
        ],
        { duration: dur("Seek"), easing:"cubic-bezier(.2,.9,.2,1)" }
      );
      peelBtn.animate(
        [{transform:"scale(1)"},{transform:"scale(1.14)"},{transform:"scale(1.05)"},{transform:"scale(1.14)"},{transform:"scale(1)"}],
        { duration: dur("Seek"), easing:"ease-in-out" }
      );
    }
  });
}

function effectBleed(){
  startFX("Bleed","fa-droplet",() => {
    const blob = document.createElement("div");
    blob.style.position="absolute";
    blob.style.left="50%"; blob.style.top="50%";
    blob.style.width="120vmax"; blob.style.height="120vmax";
    blob.style.borderRadius="999px";
    blob.style.transform="translate(-50%,-50%)";
    blob.style.background=`
      radial-gradient(circle at 30% 30%, rgba(0,0,0,.10), rgba(0,0,0,.02) 55%, rgba(0,0,0,0) 70%)
    `;
    blob.style.mixBlendMode="multiply";
    blob.style.filter="blur(10px)";
    blob.animate(
      [{transform:"translate(-50%,-50%) scale(.12)",opacity:0},
       {transform:"translate(-50%,-50%) scale(1.05)",opacity:.85,offset:.20},
       {transform:"translate(-50%,-50%) scale(1.18)",opacity:.75,offset:.75},
       {transform:"translate(-50%,-50%) scale(1.35)",opacity:0}],
      {duration:dur("Bleed"),easing:"cubic-bezier(.2,.9,.2,1)"}
    );
    fx.appendChild(blob);

    setVar("--pastel-saturate","170%");
    setVar("--pastel-brightness","118%");
  });
}

function effectBlur(){
  startFX("Blur","fa-circle-dot",() => {
    setVar("--pastel-blur","1.8px");
    setVar("--inspect-blur","1.2px");
    const bokeh = document.createElement("div");
    bokeh.style.position="absolute"; bokeh.style.inset="-15%";
    bokeh.style.background = `
      radial-gradient(circle at 20% 20%, rgba(255,255,255,.9), transparent 30%),
      radial-gradient(circle at 70% 30%, rgba(255,255,255,.8), transparent 32%),
      radial-gradient(circle at 50% 70%, rgba(255,255,255,.7), transparent 36%),
      radial-gradient(circle at 80% 80%, rgba(255,255,255,.6), transparent 34%)
    `;
    bokeh.style.mixBlendMode="screen";
    bokeh.style.filter="blur(18px)";
    bokeh.style.animation=`bokehDrift ${dur("Blur")}ms ease forwards`;
    fx.appendChild(bokeh);
  });
}

function effectReveal(){
  startFX("Reveal","fa-eye",() => {
    setVar("--inspect-opacity","0.045");
    setVar("--inspect-contrast","115%");
    setVar("--inspect-blur",".25px");
    const wash = document.createElement("div");
    wash.style.position="absolute"; wash.style.inset=0;
    wash.style.background="rgba(255,255,255,.40)";
    wash.style.mixBlendMode="screen";
    wash.style.animation=`fadeWash ${dur("Reveal")}ms ease forwards`;
    fx.appendChild(wash);
  });
}

function effectCipher(){
  startFX("Cipher","fa-shield-halved",() => {
    const rain = document.createElement("div");
    rain.style.position="absolute"; rain.style.inset=0;
    rain.style.background = `repeating-linear-gradient(
      90deg,
      rgba(0,0,0,.06) 0px,
      rgba(0,0,0,.06) 1px,
      rgba(255,255,255,0) 5px,
      rgba(255,255,255,0) 12px
    )`;
    rain.style.mixBlendMode="multiply";
    rain.style.filter="blur(.5px)";
    rain.style.animation=`matrixRain ${dur("Cipher")}ms ease forwards`;
    fx.appendChild(rain);

    const original = inspectEl.textContent;
    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
    const t = setInterval(() => {
      inspectEl.textContent = Array.from({length:7}).map(()=>chars[(Math.random()*chars.length)|0]).join("");
    }, 70);
    setTimeout(() => { clearInterval(t); inspectEl.textContent = original; }, dur("Cipher") - 150);
  });
}

function effectTone(){
  startFX("Tone","fa-palette",() => {
    const conic = document.createElement("div");
    conic.style.position="absolute"; conic.style.inset=0;
    conic.style.background = "conic-gradient(from 0deg at 50% 50%, rgba(255,255,255,.0), rgba(0,0,0,.10), rgba(255,255,255,.0), rgba(0,0,0,.08), rgba(255,255,255,.0))";
    conic.style.mixBlendMode="multiply";
    conic.style.filter="blur(1px)";
    fx.appendChild(conic);

    setVar("--pastel-huerotate","38deg");
    setVar("--pastel-contrast","125%");
    setVar("--pastel-brightness","120%");
  });
}

function effectMask(){
  startFX("Mask","fa-mask",() => {
    setVar("--vignette-opacity","1");
    const moving = document.createElement("div");
    moving.style.position="absolute"; moving.style.inset=0;
    moving.style.background = "radial-gradient(circle at 20% 30%, rgba(255,255,255,.0) 0 32%, rgba(0,0,0,.20) 70%, rgba(0,0,0,.34) 100%)";
    moving.style.mixBlendMode="multiply";
    fx.appendChild(moving);
    moving.animate(
      [
        { backgroundPosition:"0% 0%" },
        { backgroundPosition:"100% 70%" },
        { backgroundPosition:"10% 90%" }
      ],
      { duration: dur("Mask"), easing:"ease-in-out" }
    );
  });
}

function effectFold(){
  startFX("Fold","fa-square",() => {
    const fold = document.createElement("div");
    fold.style.position="absolute"; fold.style.inset=0;
    fold.style.background="linear-gradient(135deg, rgba(255,255,255,.65), rgba(0,0,0,.04))";
    fold.style.mixBlendMode="multiply";
    fold.style.animation = `foldCut ${dur("Fold")}ms ease forwards`;
    fx.appendChild(fold);
  });
}

function effectSlip(){
  startFX("Slip","fa-right-left",() => {
    const wipe = document.createElement("div");
    wipe.style.position="absolute"; wipe.style.inset="-10%";
    wipe.style.background="linear-gradient(90deg, rgba(0,0,0,0), rgba(0,0,0,.10), rgba(0,0,0,0))";
    wipe.style.mixBlendMode="multiply";
    wipe.style.animation=`wipeSlip ${dur("Slip")}ms ease forwards`;
    fx.appendChild(wipe);

    setVar("--pastel-x","-26px");
    setVar("--pastel-y","14px");
  });
}

function effectSoft(){
  startFX("Soft","fa-cloud",() => {
    const b = document.createElement("div");
    b.style.position="absolute"; b.style.inset="-20%";
    b.style.background = `
      radial-gradient(circle at 20% 35%, rgba(255,255,255,.9), transparent 55%),
      radial-gradient(circle at 70% 55%, rgba(255,255,255,.75), transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(255,255,255,.55), transparent 75%)
    `;
    b.style.mixBlendMode="screen";
    b.style.filter="blur(30px)";
    b.style.animation=`bokehDrift ${dur("Soft")}ms ease forwards`;
    fx.appendChild(b);

    setVar("--pastel-blur","1.0px");
  });
}

function effectInk(){
  startFX("Ink","fa-pen-nib",() => {
    const ink = document.createElement("div");
    ink.style.position="absolute";
    ink.style.left="50%"; ink.style.top="50%";
    ink.style.width="80vmax"; ink.style.height="80vmax";
    ink.style.borderRadius="999px";
    ink.style.background="radial-gradient(circle at 40% 35%, rgba(0,0,0,.14), rgba(0,0,0,.03) 55%, rgba(0,0,0,0) 70%)";
    ink.style.mixBlendMode="multiply";
    ink.style.animation=`inkBloom ${dur("Ink")}ms ease forwards`;
    fx.appendChild(ink);
  });
}

function effectMark(){
  startFX("Mark","fa-stamp",() => {
    const stamp = document.createElement("div");
    stamp.style.position="absolute";
    stamp.style.left="50%"; stamp.style.top="50%";
    stamp.style.transform="translate(-50%,-50%)";
    stamp.style.width="min(70vmin,680px)";
    stamp.style.height="min(38vmin,340px)";
    stamp.style.borderRadius="22px";
    stamp.style.border="10px solid rgba(0,0,0,.14)";
    stamp.style.boxShadow="0 22px 70px rgba(0,0,0,.22)";
    stamp.style.background="rgba(255,255,255,.7)";
    stamp.style.display="grid";
    stamp.style.placeItems="center";
    stamp.style.fontWeight="900";
    stamp.style.letterSpacing=".22em";
    stamp.style.textTransform="uppercase";
    stamp.textContent="MARKED";
    stamp.style.animation=`stampMark ${dur("Mark")}ms cubic-bezier(.2,.9,.2,1) forwards`;
    fx.appendChild(stamp);
  });
}

function effectShell(){
  startFX("Shell","fa-circle",() => {
    const wrap = document.createElement("div");
    wrap.style.position="absolute";
    wrap.style.left="50%"; wrap.style.top="50%";
    wrap.style.transform="translate(-50%,-50%)";
    wrap.style.width="min(84vmin,820px)";
    wrap.style.height="min(84vmin,820px)";
    fx.appendChild(wrap);

    for (let i=0;i<16;i++){
      const r = document.createElement("div");
      r.style.position="absolute";
      r.style.left="50%"; r.style.top="50%";
      const s = (i+1)/16;
      r.style.width = (100*s) + "%";
      r.style.height = (100*s) + "%";
      r.style.borderRadius="999px";
      r.style.border = `${Math.max(2, 8 - i*0.35)}px solid rgba(0,0,0,${0.12 - i*0.004})`;
      r.style.transform="translate(-50%,-50%)";
      r.style.filter="blur(.2px)";
      r.animate(
        [{transform:"translate(-50%,-50%) rotate(0deg)"},{transform:"translate(-50%,-50%) rotate(360deg)"}],
        {duration: dur("Shell") + i*60, iterations: 1, easing:"linear"}
      );
      wrap.appendChild(r);
    }
    wrap.animate([{opacity:0},{opacity:.9,offset:.15},{opacity:.85,offset:.85},{opacity:0}],{duration:dur("Shell"),easing:"ease"});
  });
}

function effectVeer(){
  startFX("Veer","fa-compass",() => {
    const compass = document.createElement("div");
    compass.style.position="absolute";
    compass.style.left="50%"; compass.style.top="50%";
    compass.style.transform="translate(-50%,-50%)";
    compass.style.width="min(60vmin,560px)";
    compass.style.height="min(60vmin,560px)";
    compass.style.borderRadius="999px";
    compass.style.border="10px solid rgba(0,0,0,.14)";
    compass.style.background="rgba(255,255,255,.55)";
    compass.style.backdropFilter="blur(14px)";
    compass.style.boxShadow="0 22px 80px rgba(0,0,0,.18)";
    compass.style.display="grid";
    compass.style.placeItems="center";
    compass.style.animation=`compassSpin ${dur("Veer")}ms cubic-bezier(.2,.9,.2,1) forwards`;
    compass.innerHTML = `<i class="fa-solid fa-compass" style="font-size:min(18vmin,150px);opacity:.9"></i>`;
    fx.appendChild(compass);
  });
}

function effectHush(){
  startFX("Hush","fa-hand",() => {
    setVar("--vignette-opacity","1");
    for (let i=0;i<4;i++){
      const ring = document.createElement("div");
      ring.style.position="absolute";
      ring.style.left="50%"; ring.style.top="50%";
      ring.style.width="18vmin"; ring.style.height="18vmin";
      ring.style.borderRadius="999px";
      ring.style.border="10px solid rgba(0,0,0,.08)";
      ring.style.filter="blur(1px)";
      ring.style.transform="translate(-50%,-50%) scale(.2)";
      ring.style.animation=`echoRings ${dur("Hush")}ms ease ${i*200}ms forwards`;
      fx.appendChild(ring);
    }
  });
}

function effectGlow(){
  startFX("Glow","fa-sun",() => {
    const aurora = document.createElement("div");
    aurora.style.position="absolute"; aurora.style.inset="-10%";
    aurora.style.background = `
      radial-gradient(circle at 25% 30%, rgba(255,255,255,.90), transparent 55%),
      radial-gradient(circle at 70% 60%, rgba(255,255,255,.55), transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(255,255,255,.35), transparent 70%)
    `;
    aurora.style.mixBlendMode="screen";
    aurora.style.filter="blur(26px)";
    aurora.style.animation=`bokehDrift ${dur("Glow")}ms ease forwards`;
    fx.appendChild(aurora);

    setVar("--pastel-brightness","126%");
    setVar("--pastel-saturate","140%");
  });
}

function effectBreak(){
  startFX("Break","fa-burst",() => {
    const shards = document.createElement("div");
    shards.style.position="absolute"; shards.style.inset=0;
    shards.style.background=`
      linear-gradient(25deg, rgba(0,0,0,0) 35%, rgba(0,0,0,.10) 36%, rgba(0,0,0,0) 38%),
      linear-gradient(75deg, rgba(0,0,0,0) 48%, rgba(0,0,0,.08) 49%, rgba(0,0,0,0) 51%),
      linear-gradient(145deg, rgba(0,0,0,0) 58%, rgba(0,0,0,.08) 59%, rgba(0,0,0,0) 61%),
      linear-gradient(210deg, rgba(0,0,0,0) 42%, rgba(0,0,0,.08) 43%, rgba(0,0,0,0) 45%)
    `;
    shards.style.mixBlendMode="multiply";
    shards.style.animation=`shardsBreak ${dur("Break")}ms ease forwards`;
    fx.appendChild(shards);

    document.body.style.animation="fxShake 1.2s ease 1";
    setTimeout(()=>document.body.style.animation="", 1200);
  });
}

function effectTerminal(){
  startFX("Terminal","fa-terminal",() => {
    const panel = document.createElement("div");
    panel.style.position="absolute";
    panel.style.left="50%"; panel.style.top="50%";
    panel.style.transform="translate(-50%,-50%)";
    panel.style.width="min(900px, 92vw)";
    panel.style.height="min(420px, 60vh)";
    panel.style.borderRadius="18px";
    panel.style.background="rgba(0,0,0,.80)";
    panel.style.boxShadow="0 24px 90px rgba(0,0,0,.28)";
    panel.style.padding="18px 18px";
    panel.style.color="rgba(255,255,255,.9)";
    panel.style.fontFamily="ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace";
    panel.style.overflow="hidden";
    panel.style.animation=`terminalType ${dur("Terminal")}ms ease forwards`;
    fx.appendChild(panel);

    const lines = [
      "> scan: begin",
      "> map: surfaces",
      "> trace: edges",
      "> decode: symbols",
      "> status: clean",
      "> scan: end"
    ];

    let i = 0;
    const out = document.createElement("div");
    out.style.whiteSpace="pre";
    out.style.fontSize="14px";
    out.style.lineHeight="1.55";
    panel.appendChild(out);

    const timer = setInterval(() => {
      out.textContent += (lines[i] + "\n");
      i++;
      if (i >= lines.length) clearInterval(timer);
    }, 420);

    console.log("%c> inspection channel: live", "font-family: ui-monospace, Menlo, Monaco, Consolas; color:#777;");
  });
}

function effectBug(){
  startFX("Bug","fa-bug",() => {
    const bug = document.createElement("div");
    bug.style.position="absolute";
    bug.style.left="0"; bug.style.top="0";
    bug.style.width="clamp(120px, 14vw, 220px)";
    bug.style.filter="drop-shadow(0 18px 22px rgba(0,0,0,.25))";
    bug.style.animation = `bugPro ${dur("Bug")}ms ease-in-out forwards`;
    bug.innerHTML = `
<svg viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
  <defs>
    <radialGradient id="body" cx="35%" cy="30%" r="75%">
      <stop offset="0%" stop-color="rgba(255,255,255,.35)"/>
      <stop offset="55%" stop-color="rgba(255,255,255,.10)"/>
      <stop offset="100%" stop-color="rgba(255,255,255,0)"/>
    </radialGradient>
  </defs>
  <ellipse cx="110" cy="122" rx="72" ry="66" fill="rgba(0,0,0,.90)"/>
  <ellipse cx="110" cy="122" rx="62" ry="56" fill="url(#body)"/>
  <circle cx="110" cy="62" r="34" fill="rgba(0,0,0,.92)"/>
  <rect x="106" y="56" width="8" height="132" rx="4" fill="rgba(255,255,255,.10)"/>
  <circle cx="86" cy="118" r="10" fill="rgba(255,255,255,.10)"/>
  <circle cx="142" cy="112" r="9" fill="rgba(255,255,255,.10)"/>
  <circle cx="84" cy="150" r="8" fill="rgba(255,255,255,.08)"/>
  <circle cx="150" cy="146" r="9" fill="rgba(255,255,255,.08)"/>
  <g stroke="rgba(0,0,0,.92)" stroke-width="10" stroke-linecap="round" fill="none">
    <path d="M60 110 C30 94, 28 74, 56 66"/>
    <path d="M160 110 C190 94, 192 74, 164 66"/>
    <path d="M58 140 C26 132, 24 110, 52 102"/>
    <path d="M162 140 C194 132, 196 110, 168 102"/>
  </g>
</svg>
`;
    fx.appendChild(bug);
  });
}

function effectNetwork(){
  startFX("Network","fa-network-wired",() => {
    const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svg.setAttribute("viewBox","0 0 1000 600");
    svg.style.position="absolute"; svg.style.inset=0;
    svg.style.width="100%"; svg.style.height="100%";
    svg.style.opacity=".95";
    svg.innerHTML = `
      <g stroke="rgba(0,0,0,.16)" stroke-width="6" fill="none" stroke-linecap="round">
        <path d="M120,140 L280,210 L420,120 L610,210 L760,140"/>
        <path d="M280,210 L350,360 L520,390 L610,210"/>
        <path d="M350,360 L240,470 L420,520 L620,480"/>
      </g>
      <g fill="rgba(0,0,0,.18)">
        <circle cx="120" cy="140" r="16"/>
        <circle cx="280" cy="210" r="16"/>
        <circle cx="420" cy="120" r="16"/>
        <circle cx="610" cy="210" r="16"/>
        <circle cx="760" cy="140" r="16"/>
        <circle cx="350" cy="360" r="16"/>
        <circle cx="520" cy="390" r="16"/>
        <circle cx="240" cy="470" r="16"/>
        <circle cx="420" cy="520" r="16"/>
        <circle cx="620" cy="480" r="16"/>
      </g>
    `;
    fx.appendChild(svg);
    svg.animate([{opacity:0},{opacity:.95,offset:.12},{opacity:.85,offset:.86},{opacity:0}],{duration:dur("Network"),easing:"ease"});
  });
}

function effectArchive(){
  startFX("Archive","fa-box-archive",() => {
    const stack = document.createElement("div");
    stack.style.position="absolute";
    stack.style.left="50%"; stack.style.top="50%";
    stack.style.transform="translate(-50%,-50%)";
    stack.style.display="grid";
    stack.style.gap="10px";
    for (let i=0;i<6;i++){
      const box = document.createElement("div");
      box.style.width="min(70vmin,740px)";
      box.style.height="min(10vmin,84px)";
      box.style.borderRadius="16px";
      box.style.background=`rgba(255,255,255,${0.65 - i*0.05})`;
      box.style.boxShadow="0 18px 60px rgba(0,0,0,.12)";
      box.style.border="2px solid rgba(0,0,0,.08)";
      box.style.backdropFilter="blur(16px)";
      box.style.transform=`translateX(${(i%2? 16:-16)}px)`;
      stack.appendChild(box);
    }
    fx.appendChild(stack);
    stack.animate(
      [{transform:"translate(-50%,-50%) scale(.92)",opacity:0},
       {transform:"translate(-50%,-50%) scale(1.02)",opacity:1,offset:.18},
       {transform:"translate(-50%,-50%) scale(1.02)",opacity:1,offset:.72},
       {transform:"translate(-50%,-50%) scale(1.08)",opacity:0}],
      {duration:dur("Archive"),easing:"cubic-bezier(.2,.9,.2,1)"}
    );
  });
}

function effectWave(){
  startFX("Wave","fa-wave-square",() => {
    const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svg.setAttribute("viewBox","0 0 1200 300");
    svg.style.position="absolute"; svg.style.left="0"; svg.style.right="0";
    svg.style.top="50%"; svg.style.transform="translateY(-50%)";
    svg.style.width="100%"; svg.style.height="40vh";
    svg.style.opacity=".9";
    svg.innerHTML = `
      <path d="M0 150 C 150 60, 300 240, 450 150 C 600 60, 750 240, 900 150 C 1050 60, 1150 210, 1200 150"
            fill="none" stroke="rgba(0,0,0,.14)" stroke-width="18" stroke-linecap="round"/>
    `;
    fx.appendChild(svg);
    svg.animate([{opacity:0},{opacity:.9,offset:.12},{opacity:.85,offset:.85},{opacity:0}],{duration:dur("Wave"),easing:"ease"});
    svg.animate([{transform:"translateY(-50%) translateX(-3%)"},{transform:"translateY(-50%) translateX(3%)"}],{duration:dur("Wave"),easing:"ease-in-out"});
  });
}

function effectSliders(){
  startFX("Sliders","fa-sliders",() => {
    const panel = document.createElement("div");
    panel.style.position="absolute";
    panel.style.left="50%"; panel.style.top="50%";
    panel.style.transform="translate(-50%,-50%)";
    panel.style.width="min(820px, 92vw)";
    panel.style.height="min(360px, 52vh)";
    panel.style.borderRadius="22px";
    panel.style.background="rgba(255,255,255,.62)";
    panel.style.backdropFilter="blur(18px)";
    panel.style.boxShadow="0 24px 80px rgba(0,0,0,.16)";
    panel.style.padding="18px 22px";
    panel.style.display="grid";
    panel.style.gap="18px";
    fx.appendChild(panel);

    for (let i=0;i<5;i++){
      const row = document.createElement("div");
      row.style.display="grid";
      row.style.gridTemplateColumns="1fr 1fr";
      row.style.alignItems="center";
      row.style.gap="16px";

      const bar = document.createElement("div");
      bar.style.height="14px";
      bar.style.borderRadius="999px";
      bar.style.background="rgba(0,0,0,.08)";
      bar.style.position="relative";
      const knob = document.createElement("div");
      knob.style.width="34px"; knob.style.height="34px";
      knob.style.borderRadius="999px";
      knob.style.background="rgba(0,0,0,.14)";
      knob.style.position="absolute";
      knob.style.top="50%";
      knob.style.transform="translate(-50%,-50%)";
      knob.style.left="10%";
      bar.appendChild(knob);

      const val = document.createElement("div");
      val.style.fontWeight="800";
      val.style.opacity=".7";
      val.textContent = "adjusting…";

      row.appendChild(bar);
      row.appendChild(val);
      panel.appendChild(row);

      knob.animate(
        [{left:"10%"},{left:"86%"},{left:"26%"},{left:"72%"},{left:"40%"}],
        {duration:dur("Sliders"),easing:"ease-in-out"}
      );
    }

    setVar("--pastel-contrast","125%");
    setVar("--pastel-brightness","120%");
  });
}

function effectChart(){
  startFX("Chart","fa-chart-line",() => {
    const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svg.setAttribute("viewBox","0 0 1000 500");
    svg.style.position="absolute"; svg.style.inset="0";
    svg.style.width="100%"; svg.style.height="100%";
    svg.style.opacity=".95";
    svg.innerHTML = `
      <path d="M80,380 L220,300 L360,320 L520,220 L680,250 L820,160 L920,190"
            fill="none" stroke="rgba(0,0,0,.16)" stroke-width="18" stroke-linecap="round"
            stroke-dasharray="1100" stroke-dashoffset="1100"/>
      <g fill="rgba(0,0,0,.18)">
        <circle cx="80" cy="380" r="10"/>
        <circle cx="220" cy="300" r="10"/>
        <circle cx="360" cy="320" r="10"/>
        <circle cx="520" cy="220" r="10"/>
        <circle cx="680" cy="250" r="10"/>
        <circle cx="820" cy="160" r="10"/>
        <circle cx="920" cy="190" r="10"/>
      </g>
    `;
    fx.appendChild(svg);
    const path = svg.querySelector("path");
    path.style.animation = `chartDraw ${dur("Chart")}ms ease forwards`;
  });
}

function effectScissors(){
  startFX("Scissors","fa-scissors",() => {
    const line = document.createElement("div");
    line.style.position="absolute";
    line.style.left="-20%";
    line.style.top="50%";
    line.style.width="140%";
    line.style.height="10px";
    line.style.background="rgba(0,0,0,.12)";
    line.style.mixBlendMode="multiply";
    fx.appendChild(line);

    line.animate(
      [{transform:"translateY(-50%) translateX(-120%)"},
       {transform:"translateY(-50%) translateX(0%)",offset:.35},
       {transform:"translateY(-50%) translateX(0%)",offset:.70},
       {transform:"translateY(-50%) translateX(120%)"}],
      {duration:dur("Scissors"),easing:"cubic-bezier(.2,.9,.2,1)"}
    );

    setVar("--pastel-opacity","0.55");
    setVar("--pastel-contrast","120%");
  });
}

function effectInfinity(){
  startFX("Infinity","fa-infinity",() => {
    const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svg.setAttribute("viewBox","0 0 800 400");
    svg.style.position="absolute";
    svg.style.left="50%"; svg.style.top="50%";
    svg.style.transform="translate(-50%,-50%)";
    svg.style.width="min(90vw,900px)";
    svg.style.height="min(50vh,520px)";
    svg.style.opacity=".95";
    svg.innerHTML = `
      <path d="M80,200 C160,90 280,90 360,200 C440,310 560,310 640,200 C720,90 640,90 560,200 C480,310 360,310 280,200 C200,90 120,90 80,200"
            fill="none" stroke="rgba(0,0,0,.16)" stroke-width="18" stroke-linecap="round"
            stroke-dasharray="1800" stroke-dashoffset="1800"/>
    `;
    fx.appendChild(svg);
    const path = svg.querySelector("path");
    path.animate([{strokeDashoffset:1800},{strokeDashoffset:0}],{duration:dur("Infinity"),easing:"ease-in-out"});
    svg.animate([{opacity:0},{opacity:.95,offset:.12},{opacity:.85,offset:.85},{opacity:0}],{duration:dur("Infinity"),easing:"ease"});
  });
}

function effectRotate(){
  startFX("Rotate","fa-rotate",() => {
    const wheel = document.createElement("div");
    wheel.style.position="absolute";
    wheel.style.left="50%"; wheel.style.top="50%";
    wheel.style.transform="translate(-50%,-50%)";
    wheel.style.width="min(70vmin,680px)";
    wheel.style.height="min(70vmin,680px)";
    wheel.style.borderRadius="999px";
    wheel.style.border="12px solid rgba(0,0,0,.14)";
    wheel.style.boxShadow="0 24px 80px rgba(0,0,0,.16)";
    wheel.style.background="rgba(255,255,255,.55)";
    wheel.style.backdropFilter="blur(16px)";
    fx.appendChild(wheel);

    wheel.animate([{transform:"translate(-50%,-50%) rotate(0deg)"},{transform:"translate(-50%,-50%) rotate(540deg)"}],
      {duration:dur("Rotate"),easing:"cubic-bezier(.2,.9,.2,1)"});
    wheel.animate([{opacity:0},{opacity:.95,offset:.12},{opacity:.85,offset:.85},{opacity:0}],
      {duration:dur("Rotate"),easing:"ease"});
  });
}

function effectBlind(){
  startFX("Blind","fa-eye-slash",() => {
    const blackout = document.createElement("div");
    blackout.style.position="absolute"; blackout.style.inset=0;
    blackout.style.background="rgba(0,0,0,.55)";
    blackout.style.mixBlendMode="multiply";
    fx.appendChild(blackout);
    blackout.animate([{opacity:0},{opacity:.85,offset:.18},{opacity:.85,offset:.70},{opacity:0}],{duration:dur("Blind"),easing:"ease"});
    setVar("--inspect-opacity","0.000");
  });
}

function effectDoor(){
  startFX("Door","fa-door-open",() => {
    const left = document.createElement("div");
    const right = document.createElement("div");
    [left,right].forEach(p => {
      p.style.position="absolute";
      p.style.top="10%";
      p.style.bottom="10%";
      p.style.width="50%";
      p.style.background="rgba(0,0,0,.10)";
      p.style.backdropFilter="blur(8px)";
      p.style.boxShadow="0 24px 90px rgba(0,0,0,.18)";
    });
    left.style.left="0"; right.style.right="0";
    fx.appendChild(left); fx.appendChild(right);

    left.animate([{transform:"translateX(0%)"},{transform:"translateX(-105%)"}],{duration:dur("Door"),easing:"cubic-bezier(.2,.9,.2,1)"});
    right.animate([{transform:"translateX(0%)"},{transform:"translateX(105%)"}],{duration:dur("Door"),easing:"cubic-bezier(.2,.9,.2,1)"});

    finalEl.style.opacity="0.18";
    setTimeout(()=>finalEl.style.opacity="0", 1200);
  });
}

function effectDot(){
  startFX("Dot","fa-circle-dot",() => {
    const wrap = document.createElement("div");
    wrap.style.position="absolute"; wrap.style.inset=0;
    fx.appendChild(wrap);

    const n = 140;
    for (let i=0;i<n;i++){
      const d = document.createElement("div");
      d.style.position="absolute";
      d.style.width = "10px";
      d.style.height = "10px";
      d.style.borderRadius="999px";
      d.style.background="rgba(0,0,0,.10)";
      d.style.left = (Math.random()*100) + "%";
      d.style.top = (Math.random()*100) + "%";
      wrap.appendChild(d);
      const lx = parseFloat(d.style.left);
      const ty = parseFloat(d.style.top);
      d.animate(
        [
          { transform:"translate(0,0)", opacity: 0 },
          { opacity: .9, offset: .12 },
          { transform:`translate(${(50 - lx)*0.9}vw, ${(50 - ty)*0.9}vh)`, opacity: .85, offset: .72 },
          { transform:`translate(${(50 - lx)*1.1}vw, ${(50 - ty)*1.1}vh)`, opacity: 0 }
        ],
        { duration: dur("Dot"), easing:"cubic-bezier(.2,.9,.2,1)" }
      );
    }
  });
}

/* Remaining labels: no-op fallback (should not hit) */
function effectShiftMinor(label){
  startFX(label, iconFor(label), () => {});
}

function iconFor(label){
  const found = buttonsData.find(b => b.label === label);
  return found ? found.icon : "fa-circle";
}

function runEffect(label){
  switch(label){
    case "Echo": return effectEcho();
    case "Drift": return effectDrift();
    case "Fade": return effectFade();
    case "Unlock": return effectUnlock();
    case "Trace": return effectTrace();
    case "Veil": return effectVeil();
    case "Shift": return effectShift();
    case "Open": return effectOpen();
    case "Thin": return effectThin();

    case "Crack": return effectCrack();
    case "Signal": return effectSignal();
    case "Lift": return effectLift();
    case "Ghost": return effectGhost();
    case "Mirror": return effectMirror();
    case "Pulse": return effectPulse();
    case "Layer": return effectLayer();
    case "Quiet": return effectQuiet();
    case "Hidden": return effectHidden();
    case "Seek": return effectSeek();

    case "Bleed": return effectBleed();
    case "Blur": return effectBlur();
    case "Reveal": return effectReveal();
    case "Cipher": return effectCipher();
    case "Tone": return effectTone();
    case "Mask": return effectMask();
    case "Fold": return effectFold();
    case "Slip": return effectSlip();
    case "Soft": return effectSoft();
    case "Ink": return effectInk();

    case "Mark": return effectMark();
    case "Shell": return effectShell();
    case "Veer": return effectVeer();
    case "Hush": return effectHush();
    case "Glow": return effectGlow();
    case "Break": return effectBreak();

    case "Terminal": return effectTerminal();
    case "Bug": return effectBug();
    case "Network": return effectNetwork();
    case "Archive": return effectArchive();
    case "Wave": return effectWave();

    case "Sliders": return effectSliders();
    case "Chart": return effectChart();
    case "Scissors": return effectScissors();
    case "Infinity": return effectInfinity();
    case "Rotate": return effectRotate();
    case "Blind": return effectBlind();
    case "Door": return effectDoor();
    case "Dot": return effectDot();

    default: return effectShiftMinor(label);
  }
}

/* ==========================================================
   PEEL: hide buttons, peel pastel, reveal URL
   ========================================================== */
function peel(){
  clearFX();
  fxRunning = false;

  container.style.opacity = "0";
  container.style.pointerEvents = "none";

  pastel.classList.add("peeling");

  setTimeout(() => {
    finalEl.style.opacity = "1";
  }, 950);
}

/* ==========================================================
   RENDER BUTTONS
   ========================================================== */
buttonsData.forEach((item, i) => {
  const b = document.createElement("div");
  b.className = "button";

  const iconClass = item.icon === "fa-spiral" ? "fa-circle" : item.icon;

  b.innerHTML = `<i class="fa-solid ${iconClass}"></i>${item.label}`;
  if (item.label === "Peel") peelIndexInDom = i;

  b.onclick = () => {
    if (fxRunning) return;
    b.classList.add("ping");
    setTimeout(() => b.classList.remove("ping"), 350);

    if (item.label === "Peel") return peel();
    return runEffect(item.label);
  };

  container.appendChild(b);
});

/* ==========================================================
   DEVTOOLS DETECTION + COMMENT REVEAL + 7s DELAYED BUTTONS
   ========================================================== */
let devtoolsOpened = false;

setInterval(() => {
  const open =
    window.outerWidth - window.innerWidth > 160 ||
    window.outerHeight - window.innerHeight > 160;

  if (open && !devtoolsOpened) {
    devtoolsOpened = true;

    const message = "not everything is meant to be seen";

    // Console reveal
    console.log("%c" + message, "color:#888;font-style:italic;font-size:14px;");

    // Elements reveal (hidden node)
    const note = document.createElement("div");
    note.setAttribute("data-inspection-note", message);
    note.style.display = "none";
    document.body.appendChild(note);

    setTimeout(() => {
      container.style.opacity = "1";
      container.style.pointerEvents = "auto";
    }, 7000);
  }
}, 500);
</script>
</body>
</html>
